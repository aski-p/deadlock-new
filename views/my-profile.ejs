<div class="player-detail-section">
    <div class="player-detail-container">
        <!-- Welcome Message -->
        <div class="welcome-message">
            <h1>ì•ˆë…•í•˜ì„¸ìš”, <%= user.username %>ë‹˜! ğŸ‘‹</h1>
            <p>ë°ë“œë½ì—ì„œì˜ ì—¬ëŸ¬ë¶„ì˜ í™œì•½ì„ í™•ì¸í•´ë³´ì„¸ìš”!</p>
            <div class="quick-actions">
                <a href="/ko/leaderboards/asia" class="action-btn secondary">ğŸ† ë¦¬ë”ë³´ë“œ</a>
                <a href="<%= user.profileUrl || '#' %>" target="_blank" class="action-btn secondary">ğŸ® Steam</a>
            </div>
        </div>

        <!-- Loading State -->
        <div class="table-loading" id="player-loading">
            <div class="loading-spinner"></div>
            <p>í”Œë ˆì´ì–´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>

        <!-- Player Content -->
        <div class="player-content" id="player-content" style="display: none;">
            <!-- Player Header -->
            <div class="player-header">
                <div class="player-basic-info">
                    <img class="player-detail-avatar" id="player-avatar" alt="Player Avatar">
                    <div class="player-main-info">
                        <h1 class="player-name" id="player-name">í”Œë ˆì´ì–´</h1>
                        <div class="player-meta">
                            <span class="player-country" id="player-country">ğŸŒ</span>
                            <span class="player-account-id">ê³„ì • ID: <%= accountId %></span>
                            <% if (user && user.steamId) { %>
                            <span class="player-steam-id">Steam ID: <%= user.steamId %></span>
                            <% } %>
                        </div>
                    </div>
                </div>
                <div class="player-rank">
                    <div class="rank-badge">
                        <img class="rank-medal" id="rank-medal" alt="Rank Medal">
                        <div class="rank-info">
                            <span class="rank-name" id="rank-name">Oracle</span>
                            <span class="rank-score" id="rank-score">3500</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Player Stats -->
            <div class="player-stats">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-matches">0</div>
                        <div class="stat-label">ë§¤ì¹˜</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-winrate">0%</div>
                        <div class="stat-label">ìŠ¹ë¥ </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-lane-winrate">0%</div>
                        <div class="stat-label">ë¼ì¸ ìŠ¹ë¥ </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-kda">0.0</div>
                        <div class="stat-label">KDA</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-souls">0</div>
                        <div class="stat-label">ì†Œìš¸/ë¶„</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-denies">0</div>
                        <div class="stat-label">ë””ë‚˜ì´</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-endorsements">0</div>
                        <div class="stat-label">ì¶”ì²œìˆ˜</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-duration">0:00</div>
                        <div class="stat-label">í‰ê·  ë§¤ì¹˜ ì‹œê°„</div>
                    </div>
                </div>
            </div>

            <!-- Heroes Section (ì „ì²´ ê²Œì„ ê¸°ë°˜) -->
            <div class="player-section">
                <h2 class="section-title">í”Œë ˆì´í•œ ì˜ì›… (ì „ì²´ ê²Œì„)</h2>
                <p class="section-note">
                    <i class="fas fa-info-circle"></i>
                    ì˜ì›… í†µê³„ëŠ” ì™¸ë¶€ API ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, ì‹¤ì œ ê²Œì„ ë‚´ ë°ì´í„°ì™€ ì•½ê°„ì˜ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                    ë°ì´í„°ëŠ” ì£¼ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.
                </p>
                <div class="heroes-grid" id="heroes-grid">
                    <!-- Heroes will be populated by JavaScript -->
                </div>
            </div>

            <!-- Recent Matches -->
            <div class="player-section">
                <h2 class="section-title">ìµœê·¼ ë§¤ì¹˜</h2>
                <div class="matches-list" id="matches-list">
                    <!-- Matches will be populated by JavaScript -->
                </div>
            </div>

            <!-- Party Stats -->
            <div class="player-section">
                <h2 class="section-title">íŒŒí‹° í†µê³„ (í•¨ê»˜ í”Œë ˆì´í•œ íŒ€ì›)</h2>
                <div class="party-stats-list" id="party-stats-list">
                    <!-- Party stats will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Error State -->
        <div class="profile-error" id="profile-error" style="display: none;">
            <h2>âš ï¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h2>
            <p>ë°ë“œë½ í†µê³„ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
            <p id="error-message" style="color: #EF4444; font-size: 14px; margin-top: 10px;"></p>
            <div style="margin-top: 20px;">
                <button onclick="loadMyProfileData()" class="retry-btn">ë‹¤ì‹œ ì‹œë„</button>
                <a href="/ko/leaderboards/asia" class="back-button" style="margin-left: 15px;">ë¦¬ë”ë³´ë“œ ë³´ê¸°</a>
            </div>
        </div>
    </div>
</div>

<style>
/* Welcome Message Styles */
.welcome-message {
    text-align: center;
    background: linear-gradient(135deg, rgba(88, 101, 242, 0.1) 0%, rgba(0, 0, 0, 0) 100%);
    padding: 30px;
    border-radius: 16px;
    margin-bottom: 30px;
    border: 1px solid rgba(88, 101, 242, 0.2);
}

.welcome-message h1 {
    font-size: 32px;
    font-weight: 700;
    color: #FFEFD7;
    margin: 0 0 10px 0;
}

.welcome-message p {
    color: #999;
    margin: 0 0 20px 0;
    font-size: 16px;
}

.quick-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

.action-btn {
    padding: 8px 16px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 500;
    font-size: 14px;
    transition: all 0.3s;
}

.action-btn.secondary {
    background: rgba(255, 255, 255, 0.1);
    color: #FFEFD7;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.action-btn.secondary:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: rgba(255, 255, 255, 0.3);
    transform: translateY(-1px);
}

/* Player Detail Styles (ê¸°ì¡´ CSS ì¬ì‚¬ìš©) */
.player-detail-section {
    padding: 120px 0 60px;
    min-height: 100vh;
    background: #000000;
}

.player-detail-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 40px;
}

/* í”Œë ˆì´ì–´ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
.player-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(255, 255, 255, 0.05);
    padding: 40px;
    border-radius: 16px;
    margin-bottom: 40px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.player-basic-info {
    display: flex;
    align-items: center;
    gap: 20px;
}

.player-detail-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid #63a2e2;
}

.player-main-info {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.player-name {
    font-size: 32px;
    font-weight: 700;
    color: #FFEFD7;
    margin: 0;
}

.player-meta {
    display: flex;
    align-items: center;
    gap: 15px;
    font-size: 16px;
    color: #999;
}

.player-country {
    font-size: 24px;
}

.player-account-id {
    font-family: monospace;
    font-size: 14px;
}

.player-rank {
    text-align: center;
}

.rank-badge {
    display: flex;
    align-items: center;
    gap: 15px;
}

.rank-medal {
    width: 64px;
    height: 64px;
}

.rank-info {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.rank-name {
    font-size: 18px;
    font-weight: 600;
    color: #63a2e2;
}

.rank-score {
    font-size: 24px;
    font-weight: 700;
    color: #FFEFD7;
}

.player-stats {
    background: rgba(255, 255, 255, 0.05);
    padding: 40px;
    border-radius: 16px;
    margin-bottom: 40px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 30px;
}

.stat-card {
    text-align: center;
    padding: 20px;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s;
}

.stat-card:hover {
    background: rgba(99, 162, 226, 0.1);
    border-color: #63a2e2;
    transform: translateY(-2px);
}

.stat-value {
    font-size: 28px;
    font-weight: 700;
    color: #63a2e2;
    margin-bottom: 8px;
    display: block;
}

.stat-label {
    font-size: 14px;
    color: #999;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.player-section {
    background: rgba(255, 255, 255, 0.05);
    padding: 40px;
    border-radius: 16px;
    margin-bottom: 40px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.section-title {
    font-size: 24px;
    font-weight: 600;
    color: #FFEFD7;
    margin-bottom: 30px;
    border-bottom: 2px solid #63a2e2;
    padding-bottom: 10px;
}

.heroes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.hero-card {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(255, 255, 255, 0.03);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s;
}

.hero-card:hover {
    background: rgba(99, 162, 226, 0.1);
    border-color: #63a2e2;
    transform: translateY(-2px);
}

.hero-card-image {
    width: 50px;
    height: 50px;
    border-radius: 8px;
}

.hero-card-info h3 {
    font-size: 16px;
    font-weight: 600;
    color: #FFEFD7;
    margin: 0 0 5px 0;
}

.hero-card-stats {
    font-size: 14px;
    color: #999;
}

/* ìƒì„¸ ì˜ì›… ì¹´ë“œ ìŠ¤íƒ€ì¼ */
.hero-card.detailed {
    flex-direction: column;
    align-items: stretch;
    padding: 25px;
    min-height: 300px;
}

.hero-card.detailed .hero-card-image {
    width: 60px;
    height: 60px;
    align-self: center;
    margin-bottom: 15px;
}

.hero-card-name {
    text-align: center;
    font-size: 18px;
    font-weight: 700;
    color: #FFEFD7;
    margin: 0 0 20px 0;
}

.hero-card-main-stats {
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.hero-card-detailed-stats {
    flex: 1;
}

.hero-stat-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    font-size: 13px;
}

.hero-stat-label {
    color: #999;
    font-weight: 500;
}

.hero-stat-value {
    color: #FFEFD7;
    font-weight: 600;
}

.hero-stat-value.positive {
    color: #10B981;
}

.hero-stat-value.negative {
    color: #EF4444;
}

/* ë§¤ì¹˜ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
.matches-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.match-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(255, 255, 255, 0.03);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s;
}

.match-card:hover {
    background: rgba(99, 162, 226, 0.1);
    border-color: #63a2e2;
}

.match-card.win {
    border-left: 4px solid #10B981;
}

.match-card.loss {
    border-left: 4px solid #EF4444;
}

.match-hero {
    display: flex;
    align-items: center;
    gap: 15px;
    min-width: 140px;
}

.match-hero-image {
    width: 40px;
    height: 40px;
    border-radius: 6px;
}

.match-hero-name {
    font-weight: 500;
    color: #FFEFD7;
}

.match-result {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 80px;
}

.result-text {
    font-weight: 600;
    font-size: 14px;
}

.win-text {
    color: #10B981;
}

.loss-text {
    color: #EF4444;
}

.unknown-text {
    color: #999;
}

.match-outcomes {
    display: flex;
    flex-direction: column;
    gap: 2px;
    margin-bottom: 4px;
}

.match-outcome {
    font-weight: 600;
    font-size: 13px;
}

.lane-outcome {
    font-weight: 500;
    font-size: 11px;
}

.match-duration {
    font-size: 12px;
    color: #999;
}

.match-id {
    font-size: 11px;
    color: #666;
    font-family: monospace;
}

.match-stats {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 80px;
}

.kda {
    font-family: monospace;
    font-size: 16px;
    color: #FFEFD7;
}

.kda-ratio {
    font-size: 12px;
    color: #999;
}

.match-performance {
    display: flex;
    gap: 20px;
    flex: 1;
}

.performance-item {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.performance-label {
    font-size: 12px;
    color: #999;
    margin-bottom: 2px;
}

.performance-value {
    font-weight: 500;
    color: #FFEFD7;
    font-size: 14px;
}

.match-time {
    font-size: 12px;
    color: #999;
    min-width: 80px;
    text-align: right;
}

/* Match Items Styles */
.match-items {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    min-width: 250px;
}

.items-label {
    font-size: 12px;
    color: #999;
    font-weight: 500;
}

.items-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 4px;
    max-width: 240px;
}

.item-wrapper {
    position: relative;
    display: inline-block;
}

.empty-slot {
    opacity: 0.3;
}

.empty-item-placeholder {
    width: 48px;
    height: 48px;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #666;
    font-size: 20px;
}

.empty-item-placeholder::before {
    content: '?';
    font-weight: bold;
}

.items-info {
    font-size: 11px;
    color: #999;
    text-align: center;
    margin-top: 4px;
    font-style: italic;
}

.item-image {
    width: 48px;
    height: 48px;
    border-radius: 4px;
    transition: transform 0.2s ease;
    object-fit: cover;
}

.item-image:hover {
    transform: scale(1.1);
}

.item-image.real-item {
    border: 2px solid #10B981;
    box-shadow: 0 0 8px rgba(16, 185, 129, 0.3);
}

.item-image.real-item:hover {
    border-color: #059669;
    box-shadow: 0 0 12px rgba(16, 185, 129, 0.5);
}

.weapon-item {
    border-color: #FF8C42 !important;
}

.vitality-item {
    border-color: #4CAF50 !important;
}

.spirit-item {
    border-color: #8E44AD !important;
}

.item-cost {
    position: absolute;
    bottom: 2px;
    right: 2px;
    background: rgba(0, 0, 0, 0.8);
    color: #FFD700;
    font-size: 10px;
    font-weight: bold;
    padding: 1px 3px;
    border-radius: 2px;
    line-height: 1;
}


/* íŒŒí‹° ìŠ¤íƒ¯ ìŠ¤íƒ€ì¼ */
.party-stats-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.party-member {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px 20px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s;
    cursor: pointer;
}

.party-member:hover {
    background: rgba(99, 162, 226, 0.1);
    border-color: #63a2e2;
    transform: translateX(5px);
}

.party-member:active {
    background: rgba(99, 162, 226, 0.15);
    border-color: #5289c7;
    transform: translateX(3px) scale(0.98);
}

.party-member-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
}

.party-member-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.party-member-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.party-member-name {
    font-weight: 600;
    color: #FFEFD7;
    font-size: 16px;
}

.party-member-matches {
    font-size: 14px;
    color: #999;
}

.party-member-winrate {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    min-width: 80px;
}

.winrate-value {
    font-size: 20px;
    font-weight: 700;
    color: #63a2e2;
}

.winrate-label {
    font-size: 12px;
    color: #999;
    text-transform: uppercase;
}

.party-member-id {
    font-size: 12px;
    color: #999;
    font-family: monospace;
}

.party-stats {
    display: flex;
    gap: 25px;
    flex: 1;
}

.party-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.party-stat-label {
    font-size: 12px;
    color: #999;
    margin-bottom: 4px;
}

.party-stat-value {
    font-weight: 600;
    color: #63a2e2;
    font-size: 14px;
}

.party-last-played {
    font-size: 12px;
    color: #999;
    min-width: 100px;
    text-align: right;
}

/* ì—ëŸ¬ ë° ë¡œë”© ìŠ¤íƒ€ì¼ */
.profile-error {
    text-align: center;
    padding: 100px 20px;
    color: #FFEFD7;
}

.profile-error h2 {
    font-size: 36px;
    margin-bottom: 20px;
    color: #EF4444;
}

.retry-btn {
    background: #63a2e2;
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.retry-btn:hover {
    background: #5289c7;
    transform: translateY(-2px);
}

.back-button {
    display: inline-block;
    background: rgba(255, 255, 255, 0.1);
    color: #FFEFD7;
    padding: 12px 24px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s;
}

.back-button:hover {
    background: rgba(255, 255, 255, 0.2);
    color: #FFEFD7;
}

/* íŒ€ ë­í¬ ë°°ì§€ ìŠ¤íƒ€ì¼ */
.match-meta-info {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 4px 0;
}

.team-rank-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    position: relative;
}

.rank-badge-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.rank-fallback {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: 6px;
    font-weight: bold;
    font-size: 12px;
    color: white;
    background: linear-gradient(135deg, #63a2e2, #4a90e2);
    border: 2px solid #63a2e2;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
    line-height: 1;
}

/* íŒ€ ë­í¬ í˜¸ë²„ íš¨ê³¼ */
.team-rank-badge:hover {
    transform: scale(1.1);
    transition: transform 0.2s ease;
}

.team-rank-badge:hover .rank-badge-image {
    filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.5)) brightness(1.1);
}

/* ì•„ì´í…œ ì‹œê°„ í‘œì‹œ ìŠ¤íƒ€ì¼ */
.item-wrapper {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.item-time {
    position: absolute;
    bottom: -2px;
    right: -2px;
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    font-size: 9px;
    padding: 1px 3px;
    border-radius: 3px;
    line-height: 1;
    border: 1px solid rgba(255, 255, 255, 0.2);
    z-index: 2;
}

.empty-item-placeholder {
    width: 48px;
    height: 48px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px dashed rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #666;
    font-size: 12px;
}

/* ë°˜ì‘í˜• */
@media (max-width: 768px) {
    .player-detail-container {
        padding: 0 20px;
    }
    
    .welcome-message h1 {
        font-size: 24px;
    }
    
    .quick-actions {
        flex-direction: column;
        align-items: center;
    }
    
    .player-header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }
    
    .heroes-grid {
        grid-template-columns: 1fr;
    }
    
    .match-card {
        flex-direction: column;
        gap: 12px;
        text-align: center;
    }
    
    .match-hero, .match-result, .match-stats {
        min-width: auto;
    }
    
    .match-performance {
        justify-content: center;
    }
    
    .match-time {
        text-align: center;
        min-width: auto;
    }
    
    .match-meta-info {
        flex-direction: column;
        gap: 5px;
        align-items: center;
    }
    
    .team-rank-badge {
        width: 24px;
        height: 24px;
    }
    
    .rank-fallback {
        width: 20px;
        height: 20px;
        font-size: 10px;
    }
    
    .party-member {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }
    
    .party-member-info {
        min-width: auto;
    }
    
    .party-stats {
        justify-content: center;
        flex-wrap: wrap;
        gap: 15px;
    }
    
    .party-last-played {
        text-align: center;
        min-width: auto;
    }
}
</style>

<script>
// êµ­ê°€ í”Œë˜ê·¸ë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
function getCountryImage(countryFlag) {
    const flagImageMap = {
        'ğŸ‡ºğŸ‡¸': '<img src="https://flagcdn.com/24x18/us.png" alt="ë¯¸êµ­" title="ë¯¸êµ­" class="flag-image">',
        'ğŸ‡¨ğŸ‡¦': '<img src="https://flagcdn.com/24x18/ca.png" alt="ìºë‚˜ë‹¤" title="ìºë‚˜ë‹¤" class="flag-image">',
        'ğŸ‡²ğŸ‡½': '<img src="https://flagcdn.com/24x18/mx.png" alt="ë©•ì‹œì½”" title="ë©•ì‹œì½”" class="flag-image">',
        'ğŸ‡¬ğŸ‡§': '<img src="https://flagcdn.com/24x18/gb.png" alt="ì˜êµ­" title="ì˜êµ­" class="flag-image">',
        'ğŸ‡©ğŸ‡ª': '<img src="https://flagcdn.com/24x18/de.png" alt="ë…ì¼" title="ë…ì¼" class="flag-image">',
        'ğŸ‡«ğŸ‡·': '<img src="https://flagcdn.com/24x18/fr.png" alt="í”„ë‘ìŠ¤" title="í”„ë‘ìŠ¤" class="flag-image">',
        'ğŸ‡ªğŸ‡¸': '<img src="https://flagcdn.com/24x18/es.png" alt="ìŠ¤í˜ì¸" title="ìŠ¤í˜ì¸" class="flag-image">',
        'ğŸ‡®ğŸ‡¹': '<img src="https://flagcdn.com/24x18/it.png" alt="ì´íƒˆë¦¬ì•„" title="ì´íƒˆë¦¬ì•„" class="flag-image">',
        'ğŸ‡¨ğŸ‡³': '<img src="https://flagcdn.com/24x18/cn.png" alt="ì¤‘êµ­" title="ì¤‘êµ­" class="flag-image">',
        'ğŸ‡¯ğŸ‡µ': '<img src="https://flagcdn.com/24x18/jp.png" alt="ì¼ë³¸" title="ì¼ë³¸" class="flag-image">',
        'ğŸ‡°ğŸ‡·': '<img src="https://flagcdn.com/24x18/kr.png" alt="í•œêµ­" title="í•œêµ­" class="flag-image">',
        'ğŸ‡¹ğŸ‡¼': '<img src="https://flagcdn.com/24x18/tw.png" alt="ëŒ€ë§Œ" title="ëŒ€ë§Œ" class="flag-image">',
        'ğŸ‡¸ğŸ‡¬': '<img src="https://flagcdn.com/24x18/sg.png" alt="ì‹±ê°€í¬ë¥´" title="ì‹±ê°€í¬ë¥´" class="flag-image">',
        'ğŸ‡·ğŸ‡º': '<img src="https://flagcdn.com/24x18/ru.png" alt="ëŸ¬ì‹œì•„" title="ëŸ¬ì‹œì•„" class="flag-image">',
        'ğŸ‡µğŸ‡±': '<img src="https://flagcdn.com/24x18/pl.png" alt="í´ë€ë“œ" title="í´ë€ë“œ" class="flag-image">',
        'ğŸ‡¸ğŸ‡ª': '<img src="https://flagcdn.com/24x18/se.png" alt="ìŠ¤ì›¨ë´" title="ìŠ¤ì›¨ë´" class="flag-image">',
        'ğŸ‡³ğŸ‡´': '<img src="https://flagcdn.com/24x18/no.png" alt="ë…¸ë¥´ì›¨ì´" title="ë…¸ë¥´ì›¨ì´" class="flag-image">',
        'ğŸ‡©ğŸ‡°': '<img src="https://flagcdn.com/24x18/dk.png" alt="ë´ë§ˆí¬" title="ë´ë§ˆí¬" class="flag-image">',
        'ğŸ‡¹ğŸ‡­': '<img src="https://flagcdn.com/24x18/th.png" alt="íƒœêµ­" title="íƒœêµ­" class="flag-image">',
        'ğŸ‡»ğŸ‡³': '<img src="https://flagcdn.com/24x18/vn.png" alt="ë² íŠ¸ë‚¨" title="ë² íŠ¸ë‚¨" class="flag-image">',
        'ğŸ‡²ğŸ‡¾': '<img src="https://flagcdn.com/24x18/my.png" alt="ë§ë ˆì´ì‹œì•„" title="ë§ë ˆì´ì‹œì•„" class="flag-image">',
        'ğŸ‡µğŸ‡­': '<img src="https://flagcdn.com/24x18/ph.png" alt="í•„ë¦¬í•€" title="í•„ë¦¬í•€" class="flag-image">',
        'ğŸ‡®ğŸ‡©': '<img src="https://flagcdn.com/24x18/id.png" alt="ì¸ë„ë„¤ì‹œì•„" title="ì¸ë„ë„¤ì‹œì•„" class="flag-image">',
        'ğŸŒ': '<img src="https://flagcdn.com/24x18/un.png" alt="ì•Œ ìˆ˜ ì—†ìŒ" title="ì•Œ ìˆ˜ ì—†ìŒ" class="flag-image">'
    };
    
    return flagImageMap[countryFlag] || '<img src="https://flagcdn.com/24x18/un.png" alt="ì•Œ ìˆ˜ ì—†ìŒ" title="ì•Œ ìˆ˜ ì—†ìŒ" class="flag-image">';
}

async function loadMyProfileData() {
    const loading = document.getElementById('player-loading');
    const content = document.getElementById('player-content');
    const error = document.getElementById('profile-error');
    
    loading.style.display = 'flex';
    content.style.display = 'none';
    error.style.display = 'none';
    
    try {
        const accountId = '<%= accountId %>';
        console.log('ğŸ“‹ í”„ë¡œí•„ ë°ì´í„° ë¡œë”© ì‹œì‘, Account ID:', accountId);
        
        // accountId ìœ íš¨ì„± ê²€ì‚¬
        if (!accountId || accountId === 'null' || accountId === 'undefined') {
            throw new Error('Account IDê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
        }
        
        // ë³‘ë ¬ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ë™ì‹œì— ë¡œë“œ (ìºì‹œ í™œìš©ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”)
        console.log('ğŸ”„ API í˜¸ì¶œ ì‹œì‘...');
        const [playerResponse, heroStatsResponse, matchHistoryResponse, partyStatsResponse] = await Promise.all([
            fetch(`/api/v1/players/${accountId}`),
            fetch(`/api/v1/players/${accountId}/hero-stats`),
            fetch(`/api/v1/players/${accountId}/match-history?limit=10`),
            fetch(`/api/v1/players/${accountId}/party-stats`)
        ]);
        
        console.log('ğŸ“¡ API ì‘ë‹µ ìƒíƒœ:', {
            player: playerResponse.status,
            heroStats: heroStatsResponse.status,
            matchHistory: matchHistoryResponse.status,
            partyStats: partyStatsResponse.status
        });
        
        const [playerData, heroStats, matchHistory, partyStats] = await Promise.all([
            playerResponse.json(),
            heroStatsResponse.json(),
            matchHistoryResponse.json(),
            partyStatsResponse.json()
        ]);
        
        console.log('ğŸ“Š ë°›ì€ ë°ì´í„°:', {
            player: !!playerData,
            heroStats: heroStats?.length || 0,
            matchHistory: matchHistory?.length || 0,
            partyStats: partyStats?.length || 0
        });
        
        if (playerResponse.ok && playerData) {
            // ë¹ ë¥¸ UI ì—…ë°ì´íŠ¸
            updatePlayerUIFast(playerData, heroStats, matchHistory, partyStats);
            loading.style.display = 'none';
            content.style.display = 'block';
            console.log('âœ… í”„ë¡œí•„ ë°ì´í„° ë¡œë”© ì™„ë£Œ');
        } else {
            throw new Error(playerData?.error || `í”Œë ˆì´ì–´ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨ (ìƒíƒœ: ${playerResponse.status})`);
        }
        
    } catch (err) {
        console.error('âŒ í”„ë¡œí•„ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:', err);
        loading.style.display = 'none';
        error.style.display = 'block';
        
        const errorMessageEl = document.getElementById('error-message');
        if (errorMessageEl) {
            errorMessageEl.textContent = `ì˜¤ë¥˜ ìƒì„¸: ${err.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`;
        }
    }
}

// ë¹ ë¥¸ UI ì—…ë°ì´íŠ¸ - ëª¨ë“  ë°ì´í„°ë¥¼ í•œ ë²ˆì— ì²˜ë¦¬
function updatePlayerUIFast(player, heroStats, matchHistory, partyStats) {
    console.log('ğŸ¨ UI ì—…ë°ì´íŠ¸ ì‹œì‘, í”Œë ˆì´ì–´ ë°ì´í„°:', player);
    
    try {
        // Basic Info (ì•ˆì „í•œ ì ‘ê·¼)
        const avatar = player?.avatar || 'https://avatars.cloudflare.steamstatic.com/b5bd56c1aa4644a474a2e4972be27ef9e82e517e_full.jpg';
        const name = player?.name || 'Unknown Player';
        const country = player?.country || 'ğŸŒ';
        
        document.getElementById('player-avatar').src = avatar;
        document.getElementById('player-name').textContent = name;
        document.getElementById('player-country').innerHTML = getCountryImage(country);
        
        // Rank (ì•ˆì „í•œ ì ‘ê·¼)
        const getMedalImage = (medal, subrank) => {
            const medalRankMap = {
                'Eternus': 11, 'Phantom': 10, 'Oracle': 9, 'Ritualist': 8,
                'Alchemist': 7, 'Arcanist': 6, 'Initiate': 5
            };
            const rankNumber = medalRankMap[medal] || 9;
            return `https://cdn.deadlock.coach/vpk/panorama/images/ranked/badges/rank${rankNumber}/badge_sm_subrank${subrank || 1}.webp`;
        };
        
        // ì˜ì–´ ë“±ê¸‰ì„ í•œê¸€ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        const getKoreanMedal = (englishMedal) => {
            const medalTranslation = {
                'Eternus': 'ì´í„°ëˆ„ìŠ¤',
                'Phantom': 'íŒ¬í…€',
                'Oracle': 'ì˜¤ë¼í´',
                'Ritualist': 'ë¦¬ì¸„ì–¼ë¦¬ìŠ¤íŠ¸',
                'Alchemist': 'ì•Œì¼€ë¯¸ìŠ¤íŠ¸',
                'Arcanist': 'ì•„ì¼€ë‹ˆìŠ¤íŠ¸',
                'Initiate': 'íƒí—˜ê°€'
            };
            return medalTranslation[englishMedal] || englishMedal;
        };
        
        const medal = player?.rank?.medal || 'Oracle';
        const subrank = player?.rank?.subrank || 1;
        const score = player?.rank?.score || 3500;
        
        document.getElementById('rank-medal').src = getMedalImage(medal, subrank);
        document.getElementById('rank-name').textContent = `${getKoreanMedal(medal)} ${subrank}`;
        document.getElementById('rank-score').textContent = (typeof score === 'number' ? score : parseInt(score) || 3500).toLocaleString();
        
        // Stats (ì•ˆì „í•œ ì ‘ê·¼)
        const stats = player?.stats || {};
        const matches = stats.matches || 0;
        const winRate = stats.winRate || 0;
        const laneWinRate = stats.laneWinRate || 0;
        const kda = stats.kda || '0.0';
        const soulsPerMin = stats.soulsPerMin || 0;
        const denies = stats.denies || 0;
        const endorsements = stats.endorsements || 0;
        
        document.getElementById('stat-matches').textContent = matches;
        document.getElementById('stat-winrate').textContent = `${winRate}%`;
        document.getElementById('stat-lane-winrate').textContent = `${laneWinRate}%`;
        document.getElementById('stat-kda').textContent = kda;
        document.getElementById('stat-souls').textContent = (typeof soulsPerMin === 'number' ? soulsPerMin : parseInt(soulsPerMin) || 0).toLocaleString();
        document.getElementById('stat-denies').textContent = (typeof denies === 'number' ? denies : parseInt(denies) || 0).toLocaleString();
        document.getElementById('stat-endorsements').textContent = (typeof endorsements === 'number' ? endorsements : parseInt(endorsements) || 0).toLocaleString();
        
        // í‰ê·  ë§¤ì¹˜ ì‹œê°„ ì—…ë°ì´íŠ¸ (avgMatchDurationì´ ìˆë‹¤ë©´)
        if (window.playerData && window.playerData.stats && window.playerData.stats.avgMatchDuration) {
            document.getElementById('stat-duration').textContent = window.playerData.stats.avgMatchDuration;
        }
        
        console.log('âœ… ê¸°ë³¸ UI ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        
        // ì¦‰ì‹œ ì˜ì›… ë° ë§¤ì¹˜ ë°ì´í„° í‘œì‹œ
        if (heroStats && Array.isArray(heroStats) && heroStats.length > 0) {
            console.log('ğŸ¯ ì˜ì›… ìŠ¤íƒ¯ í‘œì‹œ:', heroStats.length, 'ê°œ');
            displayHeroStats(heroStats);
        } else {
            console.log('âš ï¸ ì˜ì›… ìŠ¤íƒ¯ ì—†ìŒ');
            document.getElementById('heroes-grid').innerHTML = '<p style="color: #999; text-align: center;">ì˜ì›… ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        }
        
        if (matchHistory && Array.isArray(matchHistory) && matchHistory.length > 0) {
            console.log('ğŸ“‹ ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ í‘œì‹œ:', matchHistory.length, 'ê°œ');
            displayMatchHistory(matchHistory);
        } else {
            console.log('âš ï¸ ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ ì—†ìŒ');
            document.getElementById('matches-list').innerHTML = '<p style="color: #999; text-align: center;">ìµœê·¼ ë§¤ì¹˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        }
        
        if (partyStats && Array.isArray(partyStats) && partyStats.length > 0) {
            console.log('ğŸ‘¥ íŒŒí‹° ìŠ¤íƒ¯ í‘œì‹œ:', partyStats.length, 'ê°œ');
            displayPartyStats(partyStats);
        } else {
            console.log('âš ï¸ íŒŒí‹° ìŠ¤íƒ¯ ì—†ìŒ');
            document.getElementById('party-stats-list').innerHTML = '<p style="color: #999; text-align: center;">íŒŒí‹° ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        }
        
        console.log('ğŸ‰ ëª¨ë“  UI ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        
    } catch (error) {
        console.error('âŒ UI ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜:', error);
        throw error;
    }
}

// ê¸°ì¡´ í•¨ìˆ˜ëŠ” í˜¸í™˜ì„±ì„ ìœ„í•´ ìœ ì§€
function updatePlayerUI(player) {
    // ê¸°ë³¸ ì •ë³´ë§Œ ì—…ë°ì´íŠ¸í•˜ê³  ë³„ë„ë¡œ ë¡œë“œ
    document.getElementById('player-avatar').src = player.avatar;
    document.getElementById('player-name').textContent = player.name;
    document.getElementById('player-country').textContent = player.country;
    
    const getMedalImage = (medal, subrank) => {
        const medalRankMap = {
            'Eternus': 11, 'Phantom': 10, 'Oracle': 9, 'Ritualist': 8,
            'Alchemist': 7, 'Arcanist': 6, 'Initiate': 5
        };
        const rankNumber = medalRankMap[medal] || 9;
        return `https://cdn.deadlock.coach/vpk/panorama/images/ranked/badges/rank${rankNumber}/badge_sm_subrank${subrank}.webp`;
    };
    
    // ì˜ì–´ ë“±ê¸‰ì„ í•œê¸€ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    const getKoreanMedal = (englishMedal) => {
        const medalTranslation = {
            'Eternus': 'ì´í„°ëˆ„ìŠ¤',
            'Phantom': 'íŒ¬í…€',
            'Oracle': 'ì˜¤ë¼í´',
            'Ritualist': 'ë¦¬ì¸„ì–¼ë¦¬ìŠ¤íŠ¸',
            'Alchemist': 'ì•Œì¼€ë¯¸ìŠ¤íŠ¸',
            'Arcanist': 'ì•„ì¼€ë‹ˆìŠ¤íŠ¸',
            'Initiate': 'íƒí—˜ê°€'
        };
        return medalTranslation[englishMedal] || englishMedal;
    };
    
    document.getElementById('rank-medal').src = getMedalImage(player.rank.medal, player.rank.subrank);
    document.getElementById('rank-name').textContent = `${getKoreanMedal(player.rank.medal)} ${player.rank.subrank}`;
    document.getElementById('rank-score').textContent = player.rank.score.toLocaleString();
    
    document.getElementById('stat-matches').textContent = player.stats.matches;
    document.getElementById('stat-winrate').textContent = `${player.stats.winRate}%`;
    document.getElementById('stat-lane-winrate').textContent = `${player.stats.laneWinRate}%`;
    document.getElementById('stat-kda').textContent = player.stats.kda;
    document.getElementById('stat-headshots').textContent = `${player.stats.headshotPercent}%`;
    document.getElementById('stat-souls').textContent = player.stats.soulsPerMin.toLocaleString();
    document.getElementById('stat-damage').textContent = player.stats.damagePerMin.toLocaleString();
    document.getElementById('stat-healing').textContent = player.stats.healingPerMin.toLocaleString();
    
    // í‰ê·  ë§¤ì¹˜ ì‹œê°„ ì—…ë°ì´íŠ¸ (deadlock.coach ìŠ¤íƒ€ì¼)
    if (player.stats.avgMatchDuration) {
        document.getElementById('stat-duration').textContent = player.stats.avgMatchDuration;
    }
    
    loadHeroStats(player.accountId);
    loadMatchHistory(player.accountId);
}

// ì˜ì›…ë³„ ìŠ¤íƒ¯ ë¡œë“œ
async function loadHeroStats(accountId) {
    const grid = document.getElementById('heroes-grid');
    
    try {
        const response = await fetch(`/api/v1/players/${accountId}/hero-stats`);
        const heroStats = await response.json();
        
        if (response.ok && heroStats.length > 0) {
            displayHeroStats(heroStats);
        } else {
            throw new Error('ì˜ì›… ìŠ¤íƒ¯ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
    } catch (error) {
        console.error('ì˜ì›… ìŠ¤íƒ¯ ë¡œë“œ ì‹¤íŒ¨:', error);
        grid.innerHTML = '<p style="color: #999; text-align: center;">ì˜ì›… ìŠ¤íƒ¯ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
    }
}

// ì˜ì›… ìŠ¤íƒ¯ í‘œì‹œ
function displayHeroStats(heroStats) {
    const grid = document.getElementById('heroes-grid');
    
    try {
        console.log('ğŸ¯ ì˜ì›… ìŠ¤íƒ¯ í‘œì‹œ ì‹œì‘:', heroStats);
        
        if (!Array.isArray(heroStats) || heroStats.length === 0) {
            grid.innerHTML = '<p style="color: #999; text-align: center;">ì˜ì›… ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            return;
        }
        
        const getHeroImage = (heroName) => {
            const heroImageMap = {
                'Abrams': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/bull_card.webp',
                'Bebop': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/bebop_card.webp',
                'Calico': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/nano_card.webp',
                'Dynamo': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/sumo_card.webp',
                'Grey Talon': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/archer_card.webp',
                'Haze': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/haze_card.webp',
                'Infernus': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/inferno_card.webp',
                'Ivy': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/tengu_card.webp',
                'Kelvin': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/kelvin_card.webp',
                'Lady Geist': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/spectre_card.webp',
                'Lash': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/lash_card.webp',
                'McGinnis': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/engineer_card.webp',
                'Mo & Krill': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/digger_card.webp',
                'Paradox': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/chrono_card.webp',
                'Pocket': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/synth_card.webp',
                'Seven': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/gigawatt_card.webp',
                'Shiv': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/shiv_card.webp',
                'Viper': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/kali_card.webp',
                'Viscous': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/viscous_card.webp',
                'Warden': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/warden_card.webp',
                'Vyper': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/kali_card.webp',
                'Holliday': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/astro_card.webp',
                'Mirage': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/mirage_card.webp',
                'Wraith': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/wraith_card.webp',
                'Yamato': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/yamato_card.webp',
                'Sinclair': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/magician_card.webp'
            };
            return heroImageMap[heroName] || 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/bull_card.webp';
        };
        
        const heroCards = heroStats.map((hero, index) => {
            try {
                // ìƒˆë¡œìš´ hero-stats API ë°ì´í„° êµ¬ì¡° ì‚¬ìš©
                const matches = parseInt(hero?.matches) || 0;
                const wins = parseInt(hero?.wins) || 0;
                const losses = parseInt(hero?.losses) || (matches - wins);
                const winRate = hero?.winRate || (matches > 0 ? Math.round((wins / matches) * 100) : 0);
                const kda = hero?.kda || '0.0';
                const avgKills = hero?.avgKills || 0;
                const avgDeaths = hero?.avgDeaths || 0;
                const avgAssists = hero?.avgAssists || 0;
                const avgSoulsPerMin = hero?.avgSoulsPerMin || 0;
                const avgDamagePerMin = hero?.avgDamagePerMin || 0;
                const avgHealingPerMin = hero?.avgHealingPerMin || 0;
                const avgMatchDuration = hero?.avgMatchDuration || 0;
                const durationFormatted = hero?.avgMatchDurationFormatted || 
                    (avgMatchDuration > 0 ? `${Math.floor(avgMatchDuration / 60)}:${(avgMatchDuration % 60).toString().padStart(2, '0')}` : '0:00');
                const heroName = hero?.hero || hero?.name || `Hero${index + 1}`;
                const accuracy = hero?.accuracy || 0;
                const critShotRate = hero?.critShotRate || 0;
                const avgLevel = hero?.avgLevel || 0;
                const timePlayedHours = hero?.timePlayedTotal ? (hero.timePlayedTotal / 3600).toFixed(1) : 0;
                
                return `
                    <div class="hero-card detailed">
                        <img src="${getHeroImage(heroName)}" alt="${heroName}" class="hero-card-image">
                        <div class="hero-card-info">
                            <h3 class="hero-card-name">${heroName}</h3>
                            <div class="hero-card-main-stats">
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">ë§¤ì¹˜:</span>
                                    <span class="hero-stat-value">${matches} (${wins}ìŠ¹ ${losses}íŒ¨)</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">ìŠ¹ë¥ :</span>
                                    <span class="hero-stat-value ${winRate >= 50 ? 'positive' : 'negative'}">${winRate}%</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">ì´ í”Œë ˆì´ ì‹œê°„:</span>
                                    <span class="hero-stat-value">${timePlayedHours}ì‹œê°„</span>
                                </div>
                            </div>
                            <div class="hero-card-detailed-stats">
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">KDA:</span>
                                    <span class="hero-stat-value">${avgKills}/${avgDeaths}/${avgAssists} (${kda})</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">í‰ê·  ë ˆë²¨:</span>
                                    <span class="hero-stat-value">${avgLevel}</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">ëª…ì¤‘ë¥ :</span>
                                    <span class="hero-stat-value">${accuracy}%</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">í¬ë¦¬í‹°ì»¬ìœ¨:</span>
                                    <span class="hero-stat-value">${critShotRate}%</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">ì†Œìš¸/ë¶„:</span>
                                    <span class="hero-stat-value">${avgSoulsPerMin.toLocaleString()}</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">ë°ë¯¸ì§€/ë¶„:</span>
                                    <span class="hero-stat-value">${avgDamagePerMin.toLocaleString()}</span>
                                </div>
                                <div class="hero-stat-row">
                                    <span class="hero-stat-label">í‰ê·  ì‹œê°„:</span>
                                    <span class="hero-stat-value">${durationFormatted}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } catch (heroError) {
                console.error('ì˜ì›… ì¹´ë“œ ìƒì„± ì˜¤ë¥˜:', heroError, hero);
                return `
                    <div class="hero-card">
                        <img src="https://cdn.deadlock.coach/vpk/panorama/images/heroes/bull_card.webp" alt="Unknown" class="hero-card-image">
                        <div class="hero-card-info">
                            <h3>Unknown Hero</h3>
                            <div class="hero-card-stats">ë°ì´í„° ì˜¤ë¥˜</div>
                        </div>
                    </div>
                `;
            }
        });
        
        grid.innerHTML = heroCards.join('');
        console.log('âœ… ì˜ì›… ìŠ¤íƒ¯ í‘œì‹œ ì™„ë£Œ');
        
    } catch (error) {
        console.error('âŒ ì˜ì›… ìŠ¤íƒ¯ í‘œì‹œ ì˜¤ë¥˜:', error);
        grid.innerHTML = '<p style="color: #ff6b6b; text-align: center;">ì˜ì›… ë°ì´í„° í‘œì‹œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
    }
}

// ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ ë¡œë“œ
async function loadMatchHistory(accountId) {
    const matchesList = document.getElementById('matches-list');
    
    try {
        const response = await fetch(`/api/v1/players/${accountId}/match-history?limit=20`);
        const matches = await response.json();
        
        if (response.ok && matches.length > 0) {
            displayMatchHistory(matches);
        } else {
            throw new Error('ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
    } catch (error) {
        console.error('ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ ë¡œë“œ ì‹¤íŒ¨:', error);
        matchesList.innerHTML = '<p style="color: #999; text-align: center;">ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
    }
}

// í–¥ìƒëœ ë°ë“œë½ ì•„ì´í…œ ë§¤ì²˜ ì‹œìŠ¤í…œ
class DeadlockItemMatcher {
    constructor() {
        this.itemsCache = null;
        this.initialized = false;
        this.apiUrl = '/api/v1/items';
    }

    async fetchItemStats() {
        if (this.itemsCache) {
            return this.itemsCache;
        }

        try {
            console.log('ğŸ’ ì•„ì´í…œ ì •ë³´ API í˜¸ì¶œ ì¤‘...');
            const response = await fetch(this.apiUrl);
            const data = await response.json();
            
            if (data.success) {
                this.itemsCache = data.data.items;
                this.initialized = true;
                console.log(`âœ… ${data.data.totalItems}ê°œ ì•„ì´í…œ ì •ë³´ ë¡œë“œ ì™„ë£Œ`);
                return this.itemsCache;
            } else {
                throw new Error(data.error || 'ì•„ì´í…œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            }
        } catch (error) {
            console.error('âŒ ì•„ì´í…œ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:', error);
            
            // í´ë°± ë°ì´í„° ì‚¬ìš©
            this.itemsCache = this.getFallbackItems();
            this.initialized = true;
            return this.itemsCache;
        }
    }

    getFallbackItems() {
        return {
            // ë¬´ê¸° ì•„ì´í…œ (Weapon Items)
            715762406: { name: 'í™•ì¥ íƒ„ì°½', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp', type: 'weapon' },
            1342610602: { name: 'ê³ ë§‰ë ¥ íƒ„í™˜', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/high_velocity_mag.webp', type: 'weapon' },
            1458044103: { name: 'ê¸°ë³¸ íƒ„ì°½', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp', type: 'weapon' },
            1835738020: { name: 'ëª¬ìŠ¤í„° íƒ„í™˜', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/monster_rounds.webp', type: 'weapon' },
            2460791803: { name: 'ê´‘ì „ì‚¬', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/berserker.webp', type: 'weapon' },
            3977876567: { name: 'í…ŒìŠ¬ë¼ íƒ„í™˜', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/tesla_bullets.webp', type: 'weapon' },
            3731635960: { name: 'ì‹ ë¹„í•œ ì •í™•ë„', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/mystic_shot.webp', type: 'weapon' },
            865846625: { name: 'ê±°ëŒ€í•œ íƒ„ì°½', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/titanic_magazine.webp', type: 'weapon' },
            1414319208: { name: 'ì‚¬ëƒ¥ê¾¼ì˜ ì˜¤ë¼', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/hunters_aura.webp', type: 'weapon' },
            
            // ìƒëª…ë ¥ ì•„ì´í…œ (Vitality Items)
            1537272748: { name: 'ì¶”ê°€ ì²´ë ¥', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_health.webp', type: 'vitality' },
            3970837787: { name: 'ì •ì‹ ë ¥ ê°‘ì˜·', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/divine_barrier.webp', type: 'vitality' },
            3791587546: { name: 'ì´ì•Œ ê°‘ì˜·', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/bullet_armor.webp', type: 'vitality' },
            2863754076: { name: 'ì¶”ê°€ ì¬ìƒ', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_regen.webp', type: 'vitality' },
            3675059374: { name: 'ì¶”ê°€ ì§€êµ¬ë ¥', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_stamina.webp', type: 'vitality' },
            2598983158: { name: 'ìŠ¤í”„ë¦°íŠ¸ ë¶€ì¸ ', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/sprint_boots.webp', type: 'vitality' },
            3730717068: { name: 'ì¹˜ìœ  ì˜ì‹', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_rite.webp', type: 'vitality' },
            1845966100: { name: 'ì§€ì† ì†ë„', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/enduring_speed.webp', type: 'vitality' },
            4033043084: { name: 'ì¹˜ìœ  ì¦ê°•ê¸°', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_booster.webp', type: 'vitality' },
            1955841979: { name: 'ê¸ˆì† í”¼ë¶€', cost: 3200, tier: 3, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/metal_skin.webp', type: 'vitality' },
            339443430: { name: 'ê±°ì‹ ìƒ', cost: 3200, tier: 3, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/colossus.webp', type: 'vitality' },
            
            // ì •ì‹ ë ¥ ì•„ì´í…œ (Spirit Items)
            2095565695: { name: 'ì¶”ê°€ ì •ì‹ ë ¥', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/extra_spirit.webp', type: 'spirit' },
            1282141666: { name: 'ì‹ ë¹„í•œ í­ë°œ', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_burst.webp', type: 'spirit' },
            3677653320: { name: 'ì •ì‹ ë ¥ íƒ€ê²©', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_strike.webp', type: 'spirit' },
            3702319013: { name: 'í•œíŒŒ', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/cold_front.webp', type: 'spirit' },
            859037655: { name: 'ë¶€íŒ¨', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/decay.webp', type: 'spirit' },
            3574779418: { name: 'ì£¼ì…ê¸°', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/infuser.webp', type: 'spirit' },
            1673325555: { name: 'ì •ì‹ ë ¥ í¡í˜ˆ', cost: 800, tier: 1, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_lifesteal.webp', type: 'spirit' },
            673001892: { name: 'ì´ë” ë³€í™˜', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/ethereal_shift.webp', type: 'spirit' },
            1656913918: { name: 'ìƒê¸‰ ì¿¨ë‹¤ìš´', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/superior_cooldown.webp', type: 'spirit' },
            3754524659: { name: 'í–¥ìƒëœ ì¿¨ë‹¤ìš´', cost: 1600, tier: 2, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_cooldown.webp', type: 'spirit' },
            3812615317: { name: 'ë©”ì•„ë¦¬ íŒŒí¸', cost: 3200, tier: 3, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/echo_shard.webp', type: 'spirit' },
            1729727717: { name: 'ì‹ ë¹„í•œ ì”í–¥', cost: 3200, tier: 3, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_reverb.webp', type: 'spirit' },
            3802996421: { name: 'ë¦¬í”„ë ˆì…”', cost: 3200, tier: 3, image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/refresher.webp', type: 'spirit' }
        };
    }

    getItemById(itemId) {
        if (!this.initialized || !this.itemsCache) {
            console.warn('âš ï¸ ì•„ì´í…œ ë§¤ì²˜ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
            return null;
        }

        const numericId = parseInt(itemId);
        const item = this.itemsCache[numericId];
        
        if (item) {
            return {
                ...item,
                type: item.type || this.getItemTypeByName(item.name),
                id: numericId
            };
        }

        return null;
    }

    getItemTypeByName(itemName) {
        const weaponItems = ['Basic Magazine', 'Close Quarters', 'Berserker', 'Monster Rounds', 'Tesla Bullets', 'Mystic Shot', 'Titanic Magazine', "Hunter's Aura", 'Headshot Booster', 'High-Velocity Mag', 'Hollow Point Ward', 'Rapid Rounds', 'Restorative Shot', 'Soul Shredder Bullets', 'Toxic Bullets'];
        const vitalityItems = ['Extra Health', 'Spirit Armor', 'Bullet Armor', 'Metal Skin', 'Colossus', 'Extra Regen', 'Extra Stamina', 'Sprint Boots', 'Healing Rite'];
        const spiritItems = ['Extra Spirit', 'Mystic Burst', 'Ethereal Shift', 'Echo Shard', 'Superior Cooldown', 'Spirit Strike', 'Cold Front', 'Decay', 'Infuser', 'Spirit Lifesteal'];
        
        if (weaponItems.includes(itemName)) return 'weapon';
        if (vitalityItems.includes(itemName)) return 'vitality';
        if (spiritItems.includes(itemName)) return 'spirit';
        return 'weapon'; // ê¸°ë³¸ê°’
    }

    parseItemName(itemName) {
        if (!itemName) return null;
        
        // Unknown Item (ID) í˜•íƒœ íŒŒì‹±
        const unknownItemMatch = itemName.match(/Unknown Item \((\d+)\)/);
        if (unknownItemMatch) {
            const itemId = parseInt(unknownItemMatch[1]);
            const item = this.getItemById(itemId);
            if (item) {
                console.log(`ğŸ”„ ì•„ì´í…œ ID ë§¤í•‘: ${itemName} â†’ ${item.name}`);
                return item;
            }
        }

        // ì§ì ‘ ì•„ì´í…œ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰
        if (this.itemsCache) {
            for (const [id, item] of Object.entries(this.itemsCache)) {
                if (item.name === itemName) {
                    return {
                        ...item,
                        type: item.type || this.getItemTypeByName(item.name),
                        id: parseInt(id)
                    };
                }
            }
        }

        return null;
    }

    getItemData(itemName) {
        const item = this.parseItemName(itemName);
        
        if (item) {
            return {
                name: item.name,
                image: item.image,
                type: item.type,
                cost: item.cost || 0,
                tier: item.tier || 1,
                id: item.id
            };
        }

        // í´ë°± ì²˜ë¦¬
        return {
            name: itemName,
            image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp',
            type: 'unknown',
            cost: 0,
            tier: 1,
            id: null
        };
    }
}

// ì•„ì´í…œ ë§¤ì¹­ ì´ˆê¸°í™” í•¨ìˆ˜
async function initializeItemMatching() {
    try {
        console.log('ğŸ”„ ì•„ì´í…œ ë§¤ì¹­ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘...');
        
        // ì „ì—­ ì•„ì´í…œ ë§¤ì²˜ ìƒì„±
        window.itemMatcher = new DeadlockItemMatcher();
        await window.itemMatcher.fetchItemStats();
        
        console.log('âœ… ì•„ì´í…œ ë§¤ì¹­ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
        
        // ê¸°ì¡´ ë§¤ì¹˜ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        updateExistingMatches();
        
    } catch (error) {
        console.error('âŒ ì•„ì´í…œ ë§¤ì¹­ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
    }
}

// ê¸°ì¡´ ë§¤ì¹˜ì˜ ì•„ì´í…œ ìŠ¬ë¡¯ ì—…ë°ì´íŠ¸
function updateExistingMatches() {
    try {
        const matchCards = document.querySelectorAll('.match-card');
        console.log(`ğŸ”„ ${matchCards.length}ê°œ ë§¤ì¹˜ ì¹´ë“œì˜ ì•„ì´í…œ ì—…ë°ì´íŠ¸ ì¤‘...`);
        
        matchCards.forEach((matchCard, matchIndex) => {
            const itemsGrid = matchCard.querySelector('.items-grid');
            if (itemsGrid && window.itemMatcher && window.itemMatcher.initialized) {
                // ë¡œë”© ë©”ì‹œì§€ê°€ ìˆëŠ” ê²½ìš° ì•„ì´í…œ ë°ì´í„° ì¬ì²˜ë¦¬
                const loadingMessage = itemsGrid.querySelector('[style*="grid-column: 1/-1"]');
                if (loadingMessage && loadingMessage.textContent.includes('ë¡œë”© ì¤‘')) {
                    console.log(`ğŸ’ ë§¤ì¹˜ ${matchIndex} ì•„ì´í…œ ì¬ì²˜ë¦¬...`);
                    
                    // ì‹¤ì œ ì•„ì´í…œ ë°ì´í„°ê°€ ìˆë‹¤ë©´ ë‹¤ì‹œ ì²˜ë¦¬ (ì´ ë¶€ë¶„ì€ ì‹¤ì œ ë§¤ì¹˜ ë°ì´í„°ì— ë”°ë¼ ì¡°ì • í•„ìš”)
                    // ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œë¡œ ë¹ˆ ìŠ¬ë¡¯ ë©”ì‹œì§€ë¥¼ ì—…ë°ì´íŠ¸
                    itemsGrid.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; color: #10B981; font-size: 11px; padding: 8px; border: 1px dashed #10B981; border-radius: 4px;">
                            <i class="fas fa-check-circle"></i> ì•„ì´í…œ ë§¤ì¹­ ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ
                        </div>
                    `;
                }
            }
        });
        
        console.log('âœ… ê¸°ì¡´ ë§¤ì¹˜ ì•„ì´í…œ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
    } catch (error) {
        console.error('âŒ ê¸°ì¡´ ë§¤ì¹˜ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
    }
}

// ë°ë“œë½ ì•„ì´í…œã…‡ê´€ë¦¬ ì‹œìŠ¤í…œ (í˜¸í™˜ì„±ì„ ìœ„í•´ ìœ ì§€)
class DeadlockItemManager {
    constructor() {
        this.itemCache = new Map();
        this.initialized = false;
        this.fallbackItems = this.initializeFallbackItems();
    }

    initializeFallbackItems() {
        return {
            'weapon': {
                'Basic Magazine': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Close Quarters': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Headshot Booster': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'High-Velocity Mag': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Hollow Point Ward': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Monster Rounds': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Rapid Rounds': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Restorative Shot': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Soul Shredder Bullets': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Titanic Magazine': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Toxic Bullets': { type: 'weapon', tier: 1, color: '#FF6B35' },
                'Active Reload': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Berserker': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Burst Fire': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Escalating Resilience': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Fleetfoot': { type: 'weapon', tier: 2, color: '#FF8C42' },
                "Hunter's Aura": { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Intensifying Magazine': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Kinetic Dash': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Long Range': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Melee Lifesteal': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Mystic Shot': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Point Blank': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Pristine Emblem': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Sharpshooter': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Slowing Bullets': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Spiritual Overflow': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Tesla Bullets': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Warp Stone': { type: 'weapon', tier: 2, color: '#FF8C42' },
                'Alchemical Fire': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Crippling Headshot': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Frenzy': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Glass Cannon': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Heroic Aura': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Inhibitor': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Lucky Shot': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Phantom Strike': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Ricochet': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Shadow Weave': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Silencer': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Vampiric Burst': { type: 'weapon', tier: 3, color: '#FFA500' },
                'Leech': { type: 'weapon', tier: 3, color: '#FFA500' }
            },
            'vitality': {
                'Extra Health': { type: 'vitality', tier: 1, color: '#4CAF50' },
                'Extra Regen': { type: 'vitality', tier: 1, color: '#4CAF50' },
                'Extra Stamina': { type: 'vitality', tier: 1, color: '#4CAF50' },
                'Sprint Boots': { type: 'vitality', tier: 1, color: '#4CAF50' },
                'Healing Rite': { type: 'vitality', tier: 1, color: '#4CAF50' },
                'Bullet Armor': { type: 'vitality', tier: 1, color: '#4CAF50' },
                'Spirit Armor': { type: 'vitality', tier: 1, color: '#4CAF50' },
                "Enchanter's Barrier": { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Enduring Speed': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Healing Booster': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Health Nova': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Majestic Leap': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Return Fire': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Restorative Locket': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Divine Barrier': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Fortitude': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Improved Bullet Armor': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Improved Spirit Armor': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Lifestrike': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Metal Skin': { type: 'vitality', tier: 3, color: '#81C784' },
                'Superior Stamina': { type: 'vitality', tier: 2, color: '#66BB6A' },
                'Combat Barrier': { type: 'vitality', tier: 3, color: '#81C784' },
                'Colossus': { type: 'vitality', tier: 3, color: '#81C784' },
                'Soul Rebirth': { type: 'vitality', tier: 3, color: '#81C784' },
                'Unstoppable': { type: 'vitality', tier: 3, color: '#81C784' }
            },
            'spirit': {
                'Extra Spirit': { type: 'spirit', tier: 1, color: '#9C27B0' },
                'Spirit Strike': { type: 'spirit', tier: 1, color: '#9C27B0' },
                'Mystic Burst': { type: 'spirit', tier: 1, color: '#9C27B0' },
                'Cold Front': { type: 'spirit', tier: 1, color: '#9C27B0' },
                'Decay': { type: 'spirit', tier: 1, color: '#9C27B0' },
                'Infuser': { type: 'spirit', tier: 1, color: '#9C27B0' },
                'Spirit Lifesteal': { type: 'spirit', tier: 1, color: '#9C27B0' },
                'Ammo Scavenger': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Bullet Resist Shredder': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Ethereal Shift': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Improved Burst': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Improved Cooldown': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Improved Reach': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Improved Spirit': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Quicksilver Reload': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Rapid Recharge': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Superior Cooldown': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Superior Duration': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Torment Pulse': { type: 'spirit', tier: 2, color: '#BA68C8' },
                'Boundless Spirit': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Curse': { type: 'spirit', tier: 3, color: '#CE93D8' },
                "Diviner's Kevlar": { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Echo Shard': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Escalating Exposure': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Frost Grenade': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Knockdown': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Magic Carpet': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Mystic Reverb': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Refresher': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Silence Glyph': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Slowing Hex': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Surge of Power': { type: 'spirit', tier: 3, color: '#CE93D8' },
                'Withering Whip': { type: 'spirit', tier: 3, color: '#CE93D8' }
            }
        };
    }

    getItemNameById(itemId) {
        const itemMap = {
            715762406: 'Basic Magazine',
            1342610602: 'Close Quarters',
            1458044103: 'Basic Magazine',
            1537272748: 'Extra Health',
            1656913918: 'Superior Cooldown',
            1835738020: 'Monster Rounds',
            2460791803: 'Berserker',
            2095565695: 'Extra Spirit',
            1282141666: 'Mystic Burst',
            1955841979: 'Metal Skin',
            339443430: 'Colossus',
            673001892: 'Ethereal Shift',
            3812615317: 'Echo Shard',
            3731635960: 'Mystic Shot',
            865846625: 'Titanic Magazine',
            1414319208: "Hunter's Aura",
            3977876567: 'Tesla Bullets',
            3970837787: 'Spirit Armor',
            3791587546: 'Bullet Armor',
            2712976700: 'Headshot Booster',
            1297326004: 'High-Velocity Mag',
            4247951502: 'Hollow Point Ward',
            2464663797: 'Rapid Rounds',
            2789634532: 'Restorative Shot',
            2829779411: 'Soul Shredder Bullets',
            2502493491: 'Toxic Bullets',
            2616956618: 'Active Reload',
            3925892505: 'Burst Fire',
            2928055866: 'Escalating Resilience',
            4015163062: 'Fleetfoot',
            1275334329: 'Intensifying Magazine',
            3423715847: 'Kinetic Dash',
            1831513066: 'Long Range',
            3536999506: 'Melee Lifesteal',
            2699888085: 'Point Blank',
            3606745462: 'Pristine Emblem',
            3508439251: 'Sharpshooter',
            3600633316: 'Slowing Bullets',
            3635659736: 'Spiritual Overflow',
            2693100866: 'Warp Stone',
            4181896897: 'Alchemical Fire',
            3725728185: 'Crippling Headshot',
            1890169084: 'Frenzy',
            1825436633: 'Glass Cannon',
            3726002346: 'Heroic Aura',
            1549482179: 'Inhibitor',
            2406133962: 'Lucky Shot',
            2547346736: 'Phantom Strike',
            3829306297: 'Ricochet',
            3742624969: 'Shadow Weave',
            3806203616: 'Silencer',
            4245983209: 'Vampiric Burst',
            2462996994: 'Leech',
            2863754076: 'Extra Regen',
            3675059374: 'Extra Stamina',
            2598983158: 'Sprint Boots',
            3730717068: 'Healing Rite',
            2712654494: "Enchanter's Barrier",
            1845966100: 'Enduring Speed',
            4033043084: 'Healing Booster',
            3965969966: 'Health Nova',
            2549827618: 'Majestic Leap',
            3738768485: 'Return Fire',
            4194838994: 'Restorative Locket',
            3986173616: 'Divine Barrier',
            1774871043: 'Fortitude',
            3537157157: 'Improved Bullet Armor',
            3732493568: 'Improved Spirit Armor',
            1751689003: 'Lifestrike',
            1829488953: 'Superior Stamina',
            3534253000: 'Combat Barrier',
            3984996802: 'Soul Rebirth',
            1743913723: 'Unstoppable',
            3677653320: 'Spirit Strike',
            3702319013: 'Cold Front',
            859037655: 'Decay',
            3574779418: 'Infuser',
            1673325555: 'Spirit Lifesteal',
            3655967536: 'Ammo Scavenger',
            2978949851: 'Bullet Resist Shredder',
            3704089726: 'Improved Burst',
            3754524659: 'Improved Cooldown',
            2944647108: 'Improved Reach',
            3792327923: 'Improved Spirit',
            4226924901: 'Quicksilver Reload',
            3984263060: 'Rapid Recharge',
            1723652463: 'Superior Duration',
            3991092218: 'Torment Pulse',
            1833936772: 'Boundless Spirit',
            1845815269: 'Curse',
            3701569419: "Diviner's Kevlar",
            2978738440: 'Escalating Exposure',
            3785419690: 'Frost Grenade',
            1743013306: 'Knockdown',
            3984079998: 'Magic Carpet',
            1729727717: 'Mystic Reverb',
            3802996421: 'Refresher',
            1722829208: 'Silence Glyph',
            3742779730: 'Slowing Hex',
            3706103885: 'Surge of Power',
            2995023008: 'Withering Whip'
        };
        return itemMap[itemId] || `Unknown Item (${itemId})`;
    }

    getItemData(itemName) {
        if (this.itemCache.has(itemName)) {
            return this.itemCache.get(itemName);
        }

        // Unknown Item (ID) í˜•íƒœ ì²˜ë¦¬
        let actualItemName = itemName;
        if (itemName && itemName.startsWith('Unknown Item (') && itemName.endsWith(')')) {
            const itemId = itemName.match(/Unknown Item \((\d+)\)/)?.[1];
            if (itemId) {
                actualItemName = this.getItemNameById(parseInt(itemId));
                console.log(`ğŸ”„ ì•„ì´í…œ ID ë§¤í•‘: ${itemName} â†’ ${actualItemName}`);
            }
        }

        // Fallback ë°ì´í„°ì—ì„œ ê²€ìƒ‰
        for (const category of Object.values(this.fallbackItems)) {
            if (category[actualItemName]) {
                const itemData = {
                    name: actualItemName,
                    ...category[actualItemName],
                    image: this.getItemImageUrl(actualItemName)
                };
                this.itemCache.set(itemName, itemData);
                return itemData;
            }
        }

        // Unknown Item ì²˜ë¦¬
        const unknownItem = {
            name: actualItemName,
            type: 'unknown',
            tier: 1,
            color: '#666666',
            image: this.getItemImageUrl('Basic Magazine')
        };
        this.itemCache.set(itemName, unknownItem);
        return unknownItem;
    }

    getItemImageUrl(itemName) {
        const itemImageMap = {
            'Basic Magazine': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp',
            'Close Quarters': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/close_quarters.webp',
            'Headshot Booster': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/headshot_booster.webp',
            'High-Velocity Mag': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/high_velocity_mag.webp',
            'Hollow Point Ward': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/hollow_point_ward.webp',
            'Monster Rounds': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/monster_rounds.webp',
            'Rapid Rounds': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/rapid_rounds.webp',
            'Restorative Shot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/restorative_shot.webp',
            'Soul Shredder Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/soul_shredder_bullets.webp',
            'Titanic Magazine': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/titanic_magazine.webp',
            'Toxic Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/toxic_bullets.webp',
            'Active Reload': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/active_reload.webp',
            'Berserker': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/berserker.webp',
            'Burst Fire': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/burst_fire.webp',
            'Escalating Resilience': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/escalating_resilience.webp',
            'Fleetfoot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/fleetfoot.webp',
            "Hunter's Aura": 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/hunters_aura.webp',
            'Intensifying Magazine': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/intensifying_magazine.webp',
            'Kinetic Dash': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/kinetic_dash.webp',
            'Long Range': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/long_range.webp',
            'Melee Lifesteal': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/melee_lifesteal.webp',
            'Mystic Shot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/mystic_shot.webp',
            'Point Blank': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/point_blank.webp',
            'Pristine Emblem': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/pristine_emblem.webp',
            'Sharpshooter': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/sharpshooter.webp',
            'Slowing Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/slowing_bullets.webp',
            'Spiritual Overflow': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/spiritual_overflow.webp',
            'Tesla Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/tesla_bullets.webp',
            'Warp Stone': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/warp_stone.webp',
            'Alchemical Fire': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/alchemical_fire.webp',
            'Crippling Headshot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/crippling_headshot.webp',
            'Frenzy': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/frenzy.webp',
            'Glass Cannon': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/glass_cannon.webp',
            'Heroic Aura': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/heroic_aura.webp',
            'Inhibitor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/inhibitor.webp',
            'Lucky Shot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/lucky_shot.webp',
            'Phantom Strike': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/phantom_strike.webp',
            'Ricochet': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/ricochet.webp',
            'Shadow Weave': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/shadow_weave.webp',
            'Silencer': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/silencer.webp',
            'Vampiric Burst': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/vampiric_burst.webp',
            'Leech': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/leech.webp',
            'Extra Health': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_health.webp',
            'Extra Regen': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_regen.webp',
            'Extra Stamina': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_stamina.webp',
            'Sprint Boots': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/sprint_boots.webp',
            'Healing Rite': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_rite.webp',
            'Bullet Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/bullet_armor.webp',
            'Spirit Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/divine_barrier.webp',
            "Enchanter's Barrier": 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/enchanters_barrier.webp',
            'Enduring Speed': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/enduring_speed.webp',
            'Healing Booster': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_booster.webp',
            'Health Nova': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/health_nova.webp',
            'Majestic Leap': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/majestic_leap.webp',
            'Return Fire': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/return_fire.webp',
            'Restorative Locket': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/restorative_locket.webp',
            'Divine Barrier': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/divine_barrier.webp',
            'Fortitude': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/fortitude.webp',
            'Improved Bullet Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/improved_bullet_armor.webp',
            'Improved Spirit Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/improved_spirit_armor.webp',
            'Lifestrike': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/lifestrike.webp',
            'Metal Skin': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/metal_skin.webp',
            'Superior Stamina': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/superior_stamina.webp',
            'Combat Barrier': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/combat_barrier.webp',
            'Colossus': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/colossus.webp',
            'Soul Rebirth': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/soul_rebirth.webp',
            'Unstoppable': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/unstoppable.webp',
            'Extra Spirit': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/extra_spirit.webp',
            'Spirit Strike': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_strike.webp',
            'Mystic Burst': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_burst.webp',
            'Cold Front': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/cold_front.webp',
            'Decay': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/decay.webp',
            'Infuser': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/infuser.webp',
            'Spirit Lifesteal': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_lifesteal.webp',
            'Ammo Scavenger': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/ammo_scavenger.webp',
            'Bullet Resist Shredder': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/bullet_resist_shredder.webp',
            'Ethereal Shift': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/ethereal_shift.webp',
            'Improved Burst': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_burst.webp',
            'Improved Cooldown': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_cooldown.webp',
            'Improved Reach': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_reach.webp',
            'Improved Spirit': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_spirit.webp',
            'Quicksilver Reload': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/quicksilver_reload.webp',
            'Rapid Recharge': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/rapid_recharge.webp',
            'Superior Cooldown': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/superior_cooldown.webp',
            'Superior Duration': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/superior_duration.webp',
            'Torment Pulse': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/torment_pulse.webp',
            'Boundless Spirit': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/boundless_spirit.webp',
            'Curse': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/curse.webp',
            "Diviner's Kevlar": 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/diviners_kevlar.webp',
            'Echo Shard': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/echo_shard.webp',
            'Escalating Exposure': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/escalating_exposure.webp',
            'Frost Grenade': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/frost_grenade.webp',
            'Knockdown': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/knockdown.webp',
            'Magic Carpet': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/magic_carpet.webp',
            'Mystic Reverb': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_reverb.webp',
            'Refresher': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/refresher.webp',
            'Silence Glyph': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/silence_glyph.webp',
            'Slowing Hex': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/slowing_hex.webp',
            'Surge of Power': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/surge_of_power.webp',
            'Withering Whip': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/withering_whip.webp'
        };
        
        return itemImageMap[itemName] || 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp';
    }
}

// í´ë°± ì•„ì´í…œ ë§¤í•‘ í•¨ìˆ˜ë“¤
function getKoreanItemName(itemId) {
    const itemMap = {
        // ë¬´ê¸° ì•„ì´í…œ (Weapon Items)
        715762406: 'í™•ì¥ íƒ„ì°½',
        1342610602: 'ê³ ë§ˆë ¥ íƒ„í™˜',
        1458044103: 'ê¸°ë³¸ íƒ„ì°½',
        1835738020: 'ëª¬ìŠ¤í„° íƒ„í™˜',
        2460791803: 'ê´‘ì „ì‚¬',
        3977876567: 'í…ŒìŠ¬ë¼ íƒ„í™˜',
        3731635960: 'ì‹ ë¹„í•œ ì •í™•ë„',
        865846625: 'ê±°ëŒ€í•œ íƒ„ì°½',
        1414319208: 'ì‚¬ëƒ¥ê¾¼ì˜ ì˜¤ë¼',
        
        // ìƒëª…ë ¥ ì•„ì´í…œ (Vitality Items)
        1537272748: 'ì¶”ê°€ ì²´ë ¥',
        3970837787: 'ì •ì‹ ë ¥ ê°‘ì˜·',
        3791587546: 'ì´ì•Œ ê°‘ì˜·',
        2863754076: 'ì¶”ê°€ ì¬ìƒ',
        3675059374: 'ì¶”ê°€ ì§€êµ¬ë ¥',
        2598983158: 'ìŠ¤í”„ë¦°íŠ¸ ë¶€ì¸ ',
        3730717068: 'ì¹˜ìœ  ì˜ì‹',
        1845966100: 'ì§€ì† ì†ë„',
        4033043084: 'ì¹˜ìœ  ì¦ê°•ê¸°',
        1955841979: 'ê¸ˆì† í”¼ë¶€',
        339443430: 'ê±°ì‹ ìƒ',
        
        // ì •ì‹ ë ¥ ì•„ì´í…œ (Spirit Items)
        2095565695: 'ì¶”ê°€ ì •ì‹ ë ¥',
        1282141666: 'ì‹ ë¹„í•œ í­ë°œ',
        3677653320: 'ì •ì‹ ë ¥ íƒ€ê²©',
        3702319013: 'í•œíŒŒ',
        859037655: 'ë¶€íŒ¨',
        3574779418: 'ì£¼ì…ê¸°',
        1673325555: 'ì •ì‹ ë ¥ í¡í˜ˆ',
        673001892: 'ì´ë” ë³€í™˜',
        1656913918: 'ìƒê¸‰ ì¿¨ë‹¤ìš´',
        3754524659: 'í–¥ìƒëœ ì¿¨ë‹¤ìš´',
        3812615317: 'ë©”ì•„ë¦¬ íŒŒí¸',
        1729727717: 'ì‹ ë¹„í•œ ì”í–¥',
        3802996421: 'ë¦¬í”„ë ˆì…”'
    };
    return itemMap[itemId] || `Unknown Item (${itemId})`;
}

function getItemImageUrl(itemName) {
    const imageMap = {
        'í™•ì¥ íƒ„ì°½': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp',
        'ê³ ë§ˆë ¥ íƒ„í™˜': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/high_velocity_mag.webp',
        'ê¸°ë³¸ íƒ„ì°½': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp',
        'ëª¬ìŠ¤í„° íƒ„í™˜': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/monster_rounds.webp',
        'ê´‘ì „ì‚¬': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/berserker.webp',
        'í…ŒìŠ¬ë¼ íƒ„í™˜': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/tesla_bullets.webp',
        'ì‹ ë¹„í•œ ì •í™•ë„': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/mystic_shot.webp',
        'ê±°ëŒ€í•œ íƒ„ì°½': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/titanic_magazine.webp',
        'ì‚¬ëƒ¥ê¾¼ì˜ ì˜¤ë¼': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/hunters_aura.webp',
        'ì¶”ê°€ ì²´ë ¥': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_health.webp',
        'ì •ì‹ ë ¥ ê°‘ì˜·': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/divine_barrier.webp',
        'ì´ì•Œ ê°‘ì˜·': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/bullet_armor.webp',
        'ì¶”ê°€ ì¬ìƒ': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_regen.webp',
        'ì¶”ê°€ ì§€êµ¬ë ¥': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_stamina.webp',
        'ìŠ¤í”„ë¦°íŠ¸ ë¶€ì¸ ': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/sprint_boots.webp',
        'ì¹˜ìœ  ì˜ì‹': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_rite.webp',
        'ì§€ì† ì†ë„': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/enduring_speed.webp',
        'ì¹˜ìœ  ì¦ê°•ê¸°': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_booster.webp',
        'ê¸ˆì† í”¼ë¶€': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/metal_skin.webp',
        'ê±°ì‹ ìƒ': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/colossus.webp',
        'ì¶”ê°€ ì •ì‹ ë ¥': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/extra_spirit.webp',
        'ì‹ ë¹„í•œ í­ë°œ': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_burst.webp',
        'ì •ì‹ ë ¥ íƒ€ê²©': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_strike.webp',
        'í•œíŒŒ': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/cold_front.webp',
        'ë¶€íŒ¨': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/decay.webp',
        'ì£¼ì…ê¸°': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/infuser.webp',
        'ì •ì‹ ë ¥ í¡í˜ˆ': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_lifesteal.webp',
        'ì´ë” ë³€í™˜': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/ethereal_shift.webp',
        'ìƒê¸‰ ì¿¨ë‹¤ìš´': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/superior_cooldown.webp',
        'í–¥ìƒëœ ì¿¨ë‹¤ìš´': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_cooldown.webp',
        'ë©”ì•„ë¦¬ íŒŒí¸': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/echo_shard.webp',
        'ì‹ ë¹„í•œ ì”í–¥': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_reverb.webp',
        'ë¦¬í”„ë ˆì…”': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/refresher.webp'
    };
    return imageMap[itemName] || 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp';
}

function getItemType(itemId) {
    const weaponItems = [715762406, 1342610602, 1458044103, 1835738020, 2460791803, 3977876567, 3731635960, 865846625, 1414319208];
    const vitalityItems = [1537272748, 3970837787, 3791587546, 2863754076, 3675059374, 2598983158, 3730717068, 1845966100, 4033043084, 1955841979, 339443430];
    const spiritItems = [2095565695, 1282141666, 3677653320, 3702319013, 859037655, 3574779418, 1673325555, 673001892, 1656913918, 3754524659, 3812615317, 1729727717, 3802996421];
    
    if (weaponItems.includes(itemId)) return 'weapon';
    if (vitalityItems.includes(itemId)) return 'vitality';
    if (spiritItems.includes(itemId)) return 'spirit';
    return 'weapon';
}

function getItemCost(itemId) {
    const costs = {
        // Tier 1 - 800 ì†Œìš¸
        715762406: 800, 1342610602: 800, 1458044103: 800, 1835738020: 800,
        1537272748: 800, 3970837787: 800, 3791587546: 800, 2863754076: 800, 3675059374: 800, 2598983158: 800, 3730717068: 800,
        2095565695: 800, 1282141666: 800, 3677653320: 800, 3702319013: 800, 859037655: 800, 3574779418: 800, 1673325555: 800,
        
        // Tier 2 - 1600 ì†Œìš¸
        2460791803: 1600, 3977876567: 1600, 3731635960: 1600, 865846625: 1600, 1414319208: 1600,
        1845966100: 1600, 4033043084: 1600,
        673001892: 1600, 1656913918: 1600, 3754524659: 1600,
        
        // Tier 3 - 3200 ì†Œìš¸
        1955841979: 3200, 339443430: 3200,
        3812615317: 3200, 1729727717: 3200, 3802996421: 3200
    };
    return costs[itemId] || 0;
}

function getItemTier(itemId) {
    const tier1 = [715762406, 1342610602, 1458044103, 1835738020, 1537272748, 3970837787, 3791587546, 2863754076, 3675059374, 2598983158, 3730717068, 2095565695, 1282141666, 3677653320, 3702319013, 859037655, 3574779418, 1673325555];
    const tier2 = [2460791803, 3977876567, 3731635960, 865846625, 1414319208, 1845966100, 4033043084, 673001892, 1656913918, 3754524659];
    const tier3 = [1955841979, 339443430, 3812615317, 1729727717, 3802996421];
    
    if (tier1.includes(itemId)) return 1;
    if (tier2.includes(itemId)) return 2;
    if (tier3.includes(itemId)) return 3;
    return 1;
}

// ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ í‘œì‹œ
function displayMatchHistory(matches) {
    const matchesList = document.getElementById('matches-list');
    
    // í–¥ìƒëœ ì•„ì´í…œ ë§¤ì¹­ ì‹œìŠ¤í…œ ì‚¬ìš© (ì „ì—­ì—ì„œ ì´ˆê¸°í™”ë¨)
    // itemMatcherê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ê¸°ë‹¤ë¦¬ê¸°
    if (!window.itemMatcher) {
        console.log('â³ itemMatcher ì´ˆê¸°í™” ëŒ€ê¸° ì¤‘...');
        // ì§§ì€ ë”±ë ˆì´ í›„ ë‹¤ì‹œ ì‹œë„
        setTimeout(() => displayMatchHistory(matches), 500);
        return;
    }
    
    try {
        console.log('ğŸ“‹ ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ í‘œì‹œ ì‹œì‘:', matches);
        
        if (!Array.isArray(matches) || matches.length === 0) {
            matchesList.innerHTML = '<p style="color: #999; text-align: center;">ìµœê·¼ ë§¤ì¹˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            return;
        }
        
        const getHeroImage = (heroName) => {
            const heroImageMap = {
                'Abrams': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/bull_card.webp',
                'Bebop': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/bebop_card.webp',
                'Calico': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/nano_card.webp',
                'Dynamo': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/sumo_card.webp',
                'Grey Talon': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/archer_card.webp',
                'Haze': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/haze_card.webp',
                'Infernus': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/inferno_card.webp',
                'Ivy': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/tengu_card.webp',
                'Kelvin': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/kelvin_card.webp',
                'Lady Geist': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/spectre_card.webp',
                'Lash': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/lash_card.webp',
                'McGinnis': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/engineer_card.webp',
                'Mo & Krill': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/digger_card.webp',
                'Paradox': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/chrono_card.webp',
                'Pocket': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/synth_card.webp',
                'Seven': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/gigawatt_card.webp',
                'Shiv': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/shiv_card.webp',
                'Viper': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/kali_card.webp',
                'Viscous': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/viscous_card.webp',
                'Warden': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/warden_card.webp',
                'Vyper': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/kali_card.webp',
                'Holliday': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/astro_card.webp',
                'Mirage': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/mirage_card.webp',
                'Wraith': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/wraith_card.webp',
                'Yamato': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/yamato_card.webp',
                'Sinclair': 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/magician_card.webp'
            };
            return heroImageMap[heroName] || 'https://cdn.deadlock.coach/vpk/panorama/images/heroes/bull_card.webp';
        };
        
        const formatDate = (dateString) => {
            try {
                const date = new Date(dateString);
                if (isNaN(date.getTime())) return 'ì•Œ ìˆ˜ ì—†ìŒ';
                
                const now = new Date();
                const diffHours = Math.floor((now - date) / (1000 * 60 * 60));
                
                if (diffHours < 1) return 'ë°©ê¸ˆ ì „';
                if (diffHours < 24) return `${diffHours}ì‹œê°„ ì „`;
                const diffDays = Math.floor(diffHours / 24);
                if (diffDays < 7) return `${diffDays}ì¼ ì „`;
                return date.toLocaleDateString('ko-KR');
            } catch (error) {
                return 'ì•Œ ìˆ˜ ì—†ìŒ';
            }
        };
        
        // ì •í™•í•œ ì•„ì´í…œ ì´ë¯¸ì§€ ë§¤í•‘ í•¨ìˆ˜
        const getItemImage = (itemNameOrId) => {
            // ì‹¤ì œ Deadlock APIì—ì„œ ì‚¬ìš©í•˜ëŠ” ì•„ì´í…œ ë§¤í•‘
            const itemImageMap = {
                // Weapon Items
                'Basic Magazine': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp',
                'Close Quarters': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/close_quarters.webp',
                'Headshot Booster': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/headshot_booster.webp',
                'High-Velocity Mag': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/high_velocity_mag.webp',
                'Hollow Point Ward': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/hollow_point_ward.webp',
                'Monster Rounds': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/monster_rounds.webp',
                'Rapid Rounds': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/rapid_rounds.webp',
                'Restorative Shot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/restorative_shot.webp',
                'Soul Shredder Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/soul_shredder_bullets.webp',
                'Titanic Magazine': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/titanic_magazine.webp',
                'Toxic Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/toxic_bullets.webp',
                'Active Reload': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/active_reload.webp',
                'Berserker': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/berserker.webp',
                'Burst Fire': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/burst_fire.webp',
                'Escalating Resilience': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/escalating_resilience.webp',
                'Fleetfoot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/fleetfoot.webp',
                'Hunter\'s Aura': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/hunters_aura.webp',
                'Intensifying Magazine': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/intensifying_magazine.webp',
                'Kinetic Dash': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/kinetic_dash.webp',
                'Long Range': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/long_range.webp',
                'Melee Lifesteal': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/melee_lifesteal.webp',
                'Mystic Shot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/mystic_shot.webp',
                'Point Blank': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/point_blank.webp',
                'Pristine Emblem': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/pristine_emblem.webp',
                'Sharpshooter': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/sharpshooter.webp',
                'Slowing Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/slowing_bullets.webp',
                'Spiritual Overflow': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/spiritual_overflow.webp',
                'Tesla Bullets': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/tesla_bullets.webp',
                'Warp Stone': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/warp_stone.webp',
                'Alchemical Fire': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/alchemical_fire.webp',
                'Crippling Headshot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/crippling_headshot.webp',
                'Frenzy': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/frenzy.webp',
                'Glass Cannon': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/glass_cannon.webp',
                'Heroic Aura': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/heroic_aura.webp',
                'Inhibitor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/inhibitor.webp',
                'Lucky Shot': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/lucky_shot.webp',
                'Phantom Strike': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/phantom_strike.webp',
                'Ricochet': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/ricochet.webp',
                'Shadow Weave': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/shadow_weave.webp',
                'Silencer': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/silencer.webp',
                'Vampiric Burst': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/vampiric_burst.webp',
                'Leech': 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/leech.webp',
                
                // Vitality Items
                'Extra Health': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_health.webp',
                'Extra Regen': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_regen.webp',
                'Extra Stamina': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_stamina.webp',
                'Melee Lifesteal': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/melee_lifesteal.webp',
                'Sprint Boots': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/sprint_boots.webp',
                'Healing Rite': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_rite.webp',
                'Bullet Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/bullet_armor.webp',
                'Spirit Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/spirit_armor.webp',
                'Enchanter\'s Barrier': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/enchanters_barrier.webp',
                'Enduring Speed': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/enduring_speed.webp',
                'Healing Booster': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/healing_booster.webp',
                'Health Nova': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/health_nova.webp',
                'Majestic Leap': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/majestic_leap.webp',
                'Return Fire': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/return_fire.webp',
                'Restorative Locket': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/restorative_locket.webp',
                'Divine Barrier': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/divine_barrier.webp',
                'Fortitude': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/fortitude.webp',
                'Improved Bullet Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/improved_bullet_armor.webp',
                'Improved Spirit Armor': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/improved_spirit_armor.webp',
                'Lifestrike': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/lifestrike.webp',
                'Metal Skin': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/metal_skin.webp',
                'Superior Stamina': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/superior_stamina.webp',
                'Combat Barrier': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/combat_barrier.webp',
                'Colossus': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/colossus.webp',
                'Leech': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/leech.webp',
                'Soul Rebirth': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/soul_rebirth.webp',
                'Unstoppable': 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/unstoppable.webp',
                
                // Spirit Items
                'Extra Spirit': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/extra_spirit.webp',
                'Spirit Strike': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_strike.webp',
                'Mystic Burst': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_burst.webp',
                'Cold Front': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/cold_front.webp',
                'Decay': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/decay.webp',
                'Infuser': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/infuser.webp',
                'Spirit Lifesteal': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_lifesteal.webp',
                'Ammo Scavenger': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/ammo_scavenger.webp',
                'Bullet Resist Shredder': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/bullet_resist_shredder.webp',
                'Ethereal Shift': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/ethereal_shift.webp',
                'Improved Burst': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_burst.webp',
                'Improved Cooldown': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_cooldown.webp',
                'Improved Reach': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_reach.webp',
                'Improved Spirit': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/improved_spirit.webp',
                'Quicksilver Reload': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/quicksilver_reload.webp',
                'Rapid Recharge': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/rapid_recharge.webp',
                'Spirit Lifesteal': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/spirit_lifesteal.webp',
                'Superior Cooldown': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/superior_cooldown.webp',
                'Superior Duration': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/superior_duration.webp',
                'Torment Pulse': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/torment_pulse.webp',
                'Boundless Spirit': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/boundless_spirit.webp',
                'Curse': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/curse.webp',
                'Diviner\'s Kevlar': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/diviners_kevlar.webp',
                'Echo Shard': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/echo_shard.webp',
                'Escalating Exposure': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/escalating_exposure.webp',
                'Frost Grenade': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/frost_grenade.webp',
                'Knockdown': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/knockdown.webp',
                'Magic Carpet': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/magic_carpet.webp',
                'Mystic Reverb': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/mystic_reverb.webp',
                'Refresher': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/refresher.webp',
                'Silence Glyph': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/silence_glyph.webp',
                'Slowing Hex': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/slowing_hex.webp',
                'Surge of Power': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/surge_of_power.webp',
                'Withering Whip': 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/withering_whip.webp'
            };
            
            // ì•„ì´í…œ ì´ë¦„ìœ¼ë¡œ ë¨¼ì € ì°¾ê¸°
            if (itemImageMap[itemNameOrId]) {
                return itemImageMap[itemNameOrId];
            }
            
            // IDë¡œ ì°¾ê¸° (í•„ìš”í•œ ê²½ìš°)
            // TODO: APIì—ì„œ ì˜¤ëŠ” ì‹¤ì œ ì•„ì´í…œ ID ë§¤í•‘ ì¶”ê°€
            
            // ê¸°ë³¸ ì´ë¯¸ì§€ (ì¹´í…Œê³ ë¦¬ë³„)
            const weaponDefault = 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp';
            const vitalityDefault = 'https://cdn.deadlock.coach/vpk/panorama/images/items/vitality/extra_health.webp';
            const spiritDefault = 'https://cdn.deadlock.coach/vpk/panorama/images/items/spirit/extra_spirit.webp';
            
            return weaponDefault; // ê¸°ë³¸ê°’
        };
        
        // ì•„ì´í…œ ì¹´í…Œê³ ë¦¬ ê²°ì • í•¨ìˆ˜
        const getItemCategory = (itemNameOrId) => {
            const weaponItems = [
                'Basic Magazine', 'Close Quarters', 'Headshot Booster', 'High-Velocity Mag', 'Hollow Point Ward',
                'Monster Rounds', 'Rapid Rounds', 'Restorative Shot', 'Soul Shredder Bullets', 'Titanic Magazine',
                'Toxic Bullets', 'Active Reload', 'Berserker', 'Burst Fire', 'Escalating Resilience', 'Fleetfoot',
                'Hunter\'s Aura', 'Intensifying Magazine', 'Kinetic Dash', 'Long Range', 'Melee Lifesteal',
                'Mystic Shot', 'Point Blank', 'Pristine Emblem', 'Sharpshooter', 'Slowing Bullets',
                'Spiritual Overflow', 'Tesla Bullets', 'Warp Stone', 'Alchemical Fire', 'Crippling Headshot',
                'Frenzy', 'Glass Cannon', 'Heroic Aura', 'Inhibitor', 'Lucky Shot', 'Phantom Strike',
                'Ricochet', 'Shadow Weave', 'Silencer', 'Vampiric Burst', 'Leech'
            ];
            
            const vitalityItems = [
                'Extra Health', 'Extra Regen', 'Extra Stamina', 'Melee Lifesteal', 'Sprint Boots', 'Healing Rite',
                'Bullet Armor', 'Spirit Armor', 'Enchanter\'s Barrier', 'Enduring Speed', 'Healing Booster',
                'Health Nova', 'Majestic Leap', 'Return Fire', 'Restorative Locket', 'Divine Barrier',
                'Fortitude', 'Improved Bullet Armor', 'Improved Spirit Armor', 'Lifestrike', 'Metal Skin',
                'Superior Stamina', 'Combat Barrier', 'Colossus', 'Soul Rebirth', 'Unstoppable'
            ];
            
            const spiritItems = [
                'Extra Spirit', 'Spirit Strike', 'Mystic Burst', 'Cold Front', 'Decay', 'Infuser',
                'Spirit Lifesteal', 'Ammo Scavenger', 'Bullet Resist Shredder', 'Ethereal Shift',
                'Improved Burst', 'Improved Cooldown', 'Improved Reach', 'Improved Spirit',
                'Quicksilver Reload', 'Rapid Recharge', 'Superior Cooldown', 'Superior Duration',
                'Torment Pulse', 'Boundless Spirit', 'Curse', 'Diviner\'s Kevlar', 'Echo Shard',
                'Escalating Exposure', 'Frost Grenade', 'Knockdown', 'Magic Carpet', 'Mystic Reverb',
                'Refresher', 'Silence Glyph', 'Slowing Hex', 'Surge of Power', 'Withering Whip'
            ];
            
            if (weaponItems.includes(itemNameOrId)) return 'weapon';
            if (vitalityItems.includes(itemNameOrId)) return 'vitality';
            if (spiritItems.includes(itemNameOrId)) return 'spirit';
            
            return 'weapon'; // ê¸°ë³¸ê°’
        };
        
        const matchCards = matches.map((match, index) => {
            try {
                // ì•ˆì „í•œ ë°ì´í„° ì¶”ì¶œ
                const hero = match?.hero || 'Unknown';
                const result = match?.result || 'ì•Œ ìˆ˜ ì—†ìŒ';
                const isWin = result === 'ìŠ¹ë¦¬';
                const matchResult = match?.matchResult || (isWin ? 'Match won' : 'Match lost');
                const laneResult = match?.laneResult || 'Lane unknown';
                const duration = match?.durationFormatted || match?.duration ? `${Math.floor(match.duration / 60)}:${(match.duration % 60).toString().padStart(2, '0')}` : '0:00';
                const kills = parseInt(match?.kills) || 0;
                const deaths = parseInt(match?.deaths) || 0;
                const assists = parseInt(match?.assists) || 0;
                const kda = match?.kda || '0.0';
                const souls = parseInt(match?.souls) || 0;
                const damage = parseInt(match?.damage) || 0;
                const playedAt = match?.playedAt || new Date().toISOString();
                const matchId = match?.matchId || 'Unknown';
                const teamRank = parseInt(match?.teamRank) || 6;
                
                return `
                    <div class="match-card ${isWin ? 'win' : 'loss'}">
                        <div class="match-hero">
                            <img src="${getHeroImage(hero)}" alt="${hero}" class="match-hero-image">
                            <span class="match-hero-name">${hero}</span>
                        </div>
                        <div class="match-result">
                            <div class="match-outcomes">
                                <span class="match-outcome ${isWin ? 'win-text' : 'loss-text'}">${matchResult}</span>
                                <span class="lane-outcome ${laneResult.includes('won') ? 'win-text' : laneResult.includes('lost') ? 'loss-text' : 'unknown-text'}">${laneResult}</span>
                            </div>
                            <div class="match-meta-info">
                                <span class="match-duration">${duration}</span>
                                <div class="team-rank-badge">
                                    <img src="https://cdn.deadlock.coach/vpk/panorama/images/ranked/badges/rank${teamRank > 3 ? Math.max(1, 7-teamRank) : teamRank}/badge_sm_subrank${teamRank}.webp" 
                                         alt="Team Rank ${teamRank}" 
                                         class="rank-badge-image"
                                         onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
                                    <span class="rank-fallback" style="display: none;">${teamRank}</span>
                                </div>
                            </div>
                            <span class="match-id">ë§¤ì¹˜ #${matchId}</span>
                        </div>
                        <div class="match-stats">
                            <span class="kda">${kills}/${deaths}/${assists}</span>
                            <span class="kda-ratio">KDA: ${kda}</span>
                        </div>
                        <div class="match-performance">
                            <div class="performance-item">
                                <span class="performance-label">ì†Œìš¸</span>
                                <span class="performance-value">${souls.toLocaleString()}</span>
                            </div>
                            <div class="performance-item">
                                <span class="performance-label">ë°ë¯¸ì§€</span>
                                <span class="performance-value">${damage.toLocaleString()}</span>
                            </div>
                        </div>
                        <div class="match-items">
                            <div class="items-label">ê²Œì„ ì¢…ë£Œ ì‹œ ì•„ì´í…œ</div>
                            <div class="items-grid" id="match-items-${index}">
                                <!-- ì•„ì´í…œ ë°ì´í„°ëŠ” ì•ˆì •ì ìœ¼ë¡œ ë¡œë“œ í›„ í‘œì‹œ -->
                                <div style="grid-column: 1/-1; text-align: center; color: #999; font-size: 12px; padding: 20px;">
                                    ë§¤ì¹˜ ë°ì´í„° ë¡œë”© ì¤‘...
                                </div>
                            </div>
                        </div>
                        <div class="match-time">
                            ${formatDate(playedAt)}
                        </div>
                    </div>
                `;
            } catch (matchError) {
                console.error('ë§¤ì¹˜ ì¹´ë“œ ìƒì„± ì˜¤ë¥˜:', matchError, match);
                return `
                    <div class="match-card">
                        <div class="match-hero">
                            <img src="https://cdn.deadlock.coach/vpk/panorama/images/heroes/bull_card.webp" alt="Unknown" class="match-hero-image">
                            <span class="match-hero-name">Unknown</span>
                        </div>
                        <div class="match-result">
                            <span class="result-text">ë°ì´í„° ì˜¤ë¥˜</span>
                        </div>
                    </div>
                `;
            }
        });
        
        matchesList.innerHTML = matchCards.join('');
        
        // ë§¤ì¹˜ ì•„ì´í…œ ë°ì´í„°ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ë¡œë“œ
        matches.forEach((match, index) => {
            const itemsContainer = document.getElementById(`match-items-${index}`);
            if (itemsContainer) {
                // ê²Œì„ ì¢…ë£Œ ì‹œì ì˜ ìµœì¢… ì•„ì´í…œë§Œ í‘œì‹œ (finalItems ìš°ì„ , ì—†ìœ¼ë©´ itemsì˜ ë§ˆì§€ë§‰ ìƒíƒœ)
                let itemsData = match.finalItems || [];
                
                // finalItemsê°€ ì—†ìœ¼ë©´ itemsì—ì„œ ê°€ì¥ ëŠ¦ì€ ì‹œê°„ì˜ ì•„ì´í…œë“¤ë§Œ ì¶”ì¶œ
                if ((!itemsData || itemsData.length === 0) && match.items && match.items.length > 0) {
                    // ê° ìŠ¬ë¡¯ë³„ë¡œ ê°€ì¥ ë§ˆì§€ë§‰ì— êµ¬ë§¤í•œ ì•„ì´í…œë§Œ ë‚¨ê¸°ê¸°
                    const finalItemsMap = new Map();
                    match.items.forEach(item => {
                        const slot = item.slot || item.slotIndex || 0;
                        const gameTime = item.gameTime || item.purchaseTime || 0;
                        
                        if (!finalItemsMap.has(slot) || gameTime > (finalItemsMap.get(slot).gameTime || 0)) {
                            finalItemsMap.set(slot, { ...item, gameTime });
                        }
                    });
                    
                    itemsData = Array.from(finalItemsMap.values())
                        .sort((a, b) => (a.slot || 0) - (b.slot || 0)); // ìŠ¬ë¡¯ ìˆœì„œëŒ€ë¡œ ì •ë ¬
                }
                
                if (itemsData && itemsData.length > 0) {
                    console.log(`ğŸ’ ë§¤ì¹˜ ${index} ì•„ì´í…œ ë°ì´í„°:`, itemsData);
                    
                    // ì‹¤ì œ API ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ í‘œì‹œ
                    const itemsHTML = itemsData.slice(0, 12).map((item, itemIndex) => {
                        let itemName = item.name;
                        let itemData;
                        
                        // ë‹¤ì–‘í•œ ì•„ì´í…œ ID ì†ŒìŠ¤ í™•ì¸
                        if (!itemName && (item.itemId || item.id)) {
                            itemName = `Unknown Item (${item.itemId || item.id})`;
                        }
                        
                        // ì•„ì´í…œ ë°ì´í„° ë§¤ì¹­ ë¡œì§ ê°œì„ 
                        itemData = null;
                        
                        // 1. window.itemMatcher ì‚¬ìš© ì‹œë„
                        if (window.itemMatcher && window.itemMatcher.initialized) {
                            console.log(`ğŸ” itemMatcherë¡œ ì•„ì´í…œ ê²€ìƒ‰: ${itemName}`);
                            itemData = window.itemMatcher.getItemData(itemName);
                            
                            // IDë¡œ ì§ì ‘ ê²€ìƒ‰ ì‹œë„
                            if ((!itemData || itemData.name.includes('Unknown')) && (item.itemId || item.id)) {
                                const itemId = item.itemId || item.id;
                                console.log(`ğŸ¯ IDë¡œ ì§ì ‘ ê²€ìƒ‰: ${itemId}`);
                                const directItem = window.itemMatcher.getItemById(itemId);
                                if (directItem) {
                                    console.log(`âœ… ID ë§¤ì¹­ ì„±ê³µ: ${itemId} â†’ ${directItem.name}`);
                                    itemData = {
                                        name: directItem.name,
                                        image: directItem.image,
                                        type: directItem.type,
                                        cost: directItem.cost || 0,
                                        tier: directItem.tier || 1
                                    };
                                }
                            }
                        }
                        
                        // 2. í´ë°± - ì§ì ‘ ì•„ì´í…œ ID ë§¤í•‘ ì‚¬ìš©
                        if (!itemData || itemData.name.includes('Unknown')) {
                            const itemId = item.itemId || item.id;
                            if (itemId) {
                                console.log(`ğŸ”„ í´ë°± ID ë§¤í•‘ ì‚¬ìš©: ${itemId}`);
                                const koreanName = getKoreanItemName(itemId);
                                if (koreanName && !koreanName.includes('Unknown')) {
                                    console.log(`âœ… í´ë°± ë§¤ì¹­ ì„±ê³µ: ${itemId} â†’ ${koreanName}`);
                                    itemData = {
                                        name: koreanName,
                                        image: getItemImageUrl(koreanName),
                                        type: getItemType(itemId),
                                        cost: getItemCost(itemId),
                                        tier: getItemTier(itemId)
                                    };
                                }
                            }
                        }
                        
                        // 3. ìµœì¢… í´ë°±
                        if (!itemData) {
                            console.log(`âš ï¸ ì•„ì´í…œ ë§¤ì¹­ ì‹¤íŒ¨: ${itemName || item.itemId || item.id}`);
                            itemData = {
                                name: itemName || `Unknown Item (${item.itemId || item.id})`,
                                image: 'https://cdn.deadlock.coach/vpk/panorama/images/items/weapon/basic_magazine.webp',
                                type: 'unknown',
                                cost: 0,
                                tier: 1
                            };
                        }
                        
                        const costDisplay = itemData.cost > 0 ? ` (${itemData.cost}ğŸ’°)` : '';
                        
                        return `
                            <div class="item-wrapper">
                                <img src="${itemData.image}" 
                                     alt="${itemData.name}" 
                                     class="item-image real-item ${itemData.type}-item" 
                                     title="${itemData.name}${costDisplay}"
                                     onerror="this.src='https://via.placeholder.com/48x48/444/fff?text=?';">
                                ${itemData.cost > 0 ? `<div class="item-cost">${itemData.cost}</div>` : ''}
                            </div>
                        `;
                    }).join('');
                    
                    // ë¹ˆ ìŠ¬ë¡¯ ì¶”ê°€ (ìµœëŒ€ 12ê°œê¹Œì§€)
                    const emptySlots = Math.max(0, 12 - itemsData.length);
                    const emptyHTML = Array(emptySlots).fill().map(() => `
                        <div class="item-wrapper empty-slot">
                            <div class="empty-item-placeholder" title="ì•„ì´í…œ ìŠ¬ë¡¯ ì—†ìŒ"></div>
                        </div>
                    `).join('');
                    
                    itemsContainer.innerHTML = itemsHTML + emptyHTML;
                } else {
                    // API ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
                    itemsContainer.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; color: #666; font-size: 11px; padding: 8px; border: 1px dashed #333; border-radius: 4px;">
                            <i class="fas fa-info-circle"></i> ì•„ì´í…œ ë°ì´í„° ë¡œë”© ì¤‘ ë˜ëŠ” ì—†ìŒ
                        </div>
                    `;
                }
            }
        });
        
        console.log('âœ… ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ í‘œì‹œ ì™„ë£Œ');
        
    } catch (error) {
        console.error('âŒ ë§¤ì¹˜ íˆìŠ¤í† ë¦¬ í‘œì‹œ ì˜¤ë¥˜:', error);
        matchesList.innerHTML = '<p style="color: #ff6b6b; text-align: center;">ë§¤ì¹˜ ë°ì´í„° í‘œì‹œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
    }
}

// íŒŒí‹° ìŠ¤íƒ¯ í‘œì‹œ
function displayPartyStats(partyStats) {
    const partyStatsList = document.getElementById('party-stats-list');
    
    try {
        console.log('ğŸ‘¥ íŒŒí‹° ìŠ¤íƒ¯ í‘œì‹œ ì‹œì‘:', partyStats);
        
        if (!Array.isArray(partyStats) || partyStats.length === 0) {
            partyStatsList.innerHTML = '<p style="color: #999; text-align: center;">íŒŒí‹° ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            return;
        }
        
        const formatDate = (dateString) => {
            try {
                if (!dateString) return 'ì•Œ ìˆ˜ ì—†ìŒ';
                const date = new Date(dateString);
                if (isNaN(date.getTime())) return 'ì•Œ ìˆ˜ ì—†ìŒ';
                
                const now = new Date();
                const diffHours = Math.floor((now - date) / (1000 * 60 * 60));
                
                if (diffHours < 1) return 'ë°©ê¸ˆ ì „';
                if (diffHours < 24) return `${diffHours}ì‹œê°„ ì „`;
                const diffDays = Math.floor(diffHours / 24);
                if (diffDays < 7) return `${diffDays}ì¼ ì „`;
                return date.toLocaleDateString('ko-KR');
            } catch (error) {
                return 'ì•Œ ìˆ˜ ì—†ìŒ';
            }
        };
        
        const partyCards = partyStats.map((member, index) => {
            try {
                // deadlock.coach ìŠ¤íƒ€ì¼ ë°ì´í„° ê²€ì¦
                if (!member || !member.accountId || member.accountId === 'undefined' || member.accountId === null) {
                    console.log('âš ï¸ ìœ íš¨í•˜ì§€ ì•Šì€ íŒŒí‹° ë©¤ë²„ ë°ì´í„°:', member);
                    return ''; // ìœ íš¨í•˜ì§€ ì•Šì€ ë°ì´í„°ëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ
                }
                
                const accountId = member.accountId;
                const name = member.name && member.name !== 'undefined' ? member.name : `Player_${accountId}`;
                const matches = parseInt(member.matches) || 0;
                const wins = parseInt(member.wins) || 0;
                const losses = parseInt(member.losses) || 0;
                const winRate = parseInt(member.winRate) || 0;
                const avgKda = member.avgKda || '0.0';
                const lastPlayed = member.lastPlayedTogether || null;
                
                return `
                    <div class="party-member" data-account-id="${accountId}">
                        <div class="party-member-avatar">
                            <img src="${member?.avatar || 'https://avatars.cloudflare.steamstatic.com/fef49e7fa7e1997310d705b2a6158ff8dc1cdfeb_full.jpg'}" 
                                 alt="${name}" 
                                 onerror="this.src='https://avatars.cloudflare.steamstatic.com/fef49e7fa7e1997310d705b2a6158ff8dc1cdfeb_full.jpg'">
                        </div>
                        <div class="party-member-info">
                            <div class="party-member-name">${name}</div>
                            <div class="party-member-matches">${matches} ë§¤ì¹˜</div>
                        </div>
                        <div class="party-member-winrate">
                            <div class="winrate-value">${winRate}%</div>
                            <div class="winrate-label">ìŠ¹ë¥ </div>
                        </div>
                    </div>
                `;
            } catch (memberError) {
                console.error('íŒŒí‹° ë©¤ë²„ ì¹´ë“œ ìƒì„± ì˜¤ë¥˜:', memberError, member);
                return `
                    <div class="party-member">
                        <div class="party-member-info">
                            <div class="party-member-name">Unknown Player</div>
                            <div class="party-member-id">ë°ì´í„° ì˜¤ë¥˜</div>
                        </div>
                    </div>
                `;
            }
        });
        
        // deadlock.coach ìŠ¤íƒ€ì¼: ë¹ˆ ì¹´ë“œëŠ” í•„í„°ë§í•˜ê³  í‘œì‹œ
        const validPartyCards = partyCards.filter(card => card.trim() !== '');
        partyStatsList.innerHTML = validPartyCards.join('');
        
        // íŒŒí‹°ì› í´ë¦­ ì‹œ í”„ë¡œí•„ ì´ë™ ê¸°ëŠ¥ ì¶”ê°€
        partyStatsList.addEventListener('click', (e) => {
            const partyMember = e.target.closest('.party-member');
            if (partyMember) {
                const accountId = partyMember.dataset.accountId;
                console.log('íŒŒí‹° ë©¤ë²„ í´ë¦­:', { accountId: accountId });
                if (accountId && accountId !== 'Unknown') {
                    console.log('í”„ë¡œí•„ í˜ì´ì§€ë¡œ ì´ë™:', `/ko/players/${accountId}`);
                    window.location.href = `/ko/players/${accountId}`;
                } else {
                    console.log('ìœ íš¨í•˜ì§€ ì•Šì€ Account ID:', accountId);
                    alert('ì´ í”Œë ˆì´ì–´ì˜ í”„ë¡œí•„ì„ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            }
        });
        
        console.log('âœ… íŒŒí‹° ìŠ¤íƒ¯ í‘œì‹œ ì™„ë£Œ');
        
    } catch (error) {
        console.error('âŒ íŒŒí‹° ìŠ¤íƒ¯ í‘œì‹œ ì˜¤ë¥˜:', error);
        partyStatsList.innerHTML = '<p style="color: #ff6b6b; text-align: center;">íŒŒí‹° ë°ì´í„° í‘œì‹œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
    }
}


// Load data when page loads
document.addEventListener('DOMContentLoaded', async () => {
    // ì•„ì´í…œ ë§¤ì¹­ ì‹œìŠ¤í…œ ë¨¼ì € ì´ˆê¸°í™”
    await initializeItemMatching();
    
    // í”„ë¡œí•„ ë°ì´í„° ë¡œë“œ
    loadMyProfileData();
});
</script>